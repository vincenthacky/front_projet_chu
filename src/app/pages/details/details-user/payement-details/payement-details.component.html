<div class="container">
  <!-- Header -->
  <div class="header-section">
    <div class="header-content">
      <!-- ✅ Bouton retour ajouté -->
      <div class="header-navigation">
        <button class="back-button" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
          Retour
        </button>
      </div>
      
      <h1 class="main-title">
        <i class="fas fa-receipt"></i>
        Détail des Paiements
        <div class="subscription-badge" *ngIf="subscription">{{ subscription.id }}</div>
      </h1>
      <p class="subtitle">Suivi complet de votre souscription terrain</p>
    </div>
  </div>

  <!-- Loading State avec nz-spin -->
  <div class="loading-container" *ngIf="loading">
    <nz-spin 
      [nzSpinning]="loading"
      [nzSize]="'large'"
      nzTip="Chargement des informations...">
      <div class="loading-placeholder"></div>
    </nz-spin>
  </div>

  <!-- Content -->
  <div class="content-section" *ngIf="!loading && subscription">
    <!-- Stats Overview -->
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-map-marked-alt"></i>
        </div>
        <div class="stat-value">{{ subscription.terrain }}</div>
        <div class="stat-label">Type de terrain</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-money-bill"></i>
        </div>
        <div class="stat-value">{{ formatNumber(subscription.prixTotal) }}</div>
        <div class="stat-label">Prix total</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-coins"></i>
        </div>
        <div class="stat-value" [style.color]="getMontantPayeColor()">{{ formatNumber(subscription.montantPaye) }}</div>
        <div class="stat-label">Montant payé</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-coins"></i>
        </div>
        <div class="stat-value" [style.color]="getResteAPayerColor()">{{ formatNumber(subscription.resteAPayer) }}</div>
        <div class="stat-label">Reste à payer</div>
      </div>
    </div>

    <!-- Progress Section -->
    <div class="progress-section">
      <div class="progress-header">
        <h3 class="progress-title">
          <i class="fas fa-chart-line"></i>
          Progression du paiement
        </h3>
        <div class="progress-percentage">{{ subscription.progression }}%</div>
      </div>
      <div class="progress-bar-container">
        <div class="progress-bar-fill" [style.width.%]="subscription.progression"></div>
      </div>
    </div>

    <!-- Payment History -->
    <div class="payment-history">
      <div class="history-header">
        <h3 class="history-title">
          <i class="fas fa-history"></i>
          Historique des paiements
        </h3>
      </div>
      <div class="payment-list">
        <div class="payment-item" *ngFor="let payment of subscription.payments; trackBy: trackByPayment">
          <div class="payment-content">
            <div class="payment-date">
              <i class="fas fa-calendar-alt"></i>
              {{ payment.date }}
            </div>
            <div class="payment-amount">
              {{ formatNumber(payment.amount) }} FCFA
            </div>
          </div>
        </div>
        <nz-empty 
          *ngIf="!loading && (!subscription.payments || subscription.payments.length === 0)"
          class="no-payments-empty"
          nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
          nzNotFoundContent="Aucun paiement enregistré">
          <div nz-empty-description class="empty-description">
            <p><strong>Aucun paiement n'a encore été effectué pour cette souscription.</strong></p>
          </div>
        </nz-empty>
      </div>
    </div>
  </div>
</div>