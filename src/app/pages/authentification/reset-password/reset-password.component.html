<div class="reset-password-container">
    <div class="reset-password-card fade-in">
      <div class="header">
        <div class="logo">🔒</div>
        <h2>Réinitialiser votre mot de passe</h2>
        <p>Saisissez votre nouveau mot de passe ci-dessous</p>
      </div>
  
      <form nz-form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="reset-form">
        
        <!-- Nouveau mot de passe -->
        <nz-form-item>
          <nz-form-label nzRequired>Nouveau mot de passe</nz-form-label>
          <nz-form-control [nzValidateStatus]="password.invalid && password.touched ? 'error' : ''">
            
            <nz-input-group nzSuffix>
              <input
                [type]="passwordVisible ? 'text' : 'password'"
                nz-input
                placeholder="Saisissez votre nouveau mot de passe"
                formControlName="password"
                class="password-input">
              <span 
                nz-input-group-slot="suffix"
                (click)="togglePasswordVisibility()"
                class="password-toggle">
                {{ passwordVisible ? '👁️' : '👁️‍🗨️' }}
              </span>
            </nz-input-group>
            
            <!-- Indicateur de force -->
            <div *ngIf="password.value && password.value.length > 0" class="password-strength">
              <div class="strength-bar">
                <div class="strength-fill" 
                     [style.width.%]="getPasswordStrength() * 20"
                     [style.background-color]="getPasswordStrengthColor()">
                </div>
              </div>
              <span class="strength-text" [style.color]="getPasswordStrengthColor()">
                {{ getPasswordStrengthText() }}
              </span>
            </div>
            
            <!-- Exigences du mot de passe -->
            <div *ngIf="password.touched && password.errors" class="password-requirements">
              <div class="requirement-title">Le mot de passe doit contenir :</div>
              
              <div class="requirement-item" 
                   [class.valid]="!password.errors['minLength']"
                   [class.invalid]="password.errors['minLength']">
                {{ !password.errors['minLength'] ? '✅' : '❌' }} Au moins 8 caractères
              </div>
              
              <div class="requirement-item" 
                   [class.valid]="!password.errors['lowercase']"
                   [class.invalid]="password.errors['lowercase']">
                {{ !password.errors['lowercase'] ? '✅' : '❌' }} Une minuscule (a-z)
              </div>
              
              <div class="requirement-item" 
                   [class.valid]="!password.errors['uppercase']"
                   [class.invalid]="password.errors['uppercase']">
                {{ !password.errors['uppercase'] ? '✅' : '❌' }} Une majuscule (A-Z)
              </div>
              
              <div class="requirement-item" 
                   [class.valid]="!password.errors['digit']"
                   [class.invalid]="password.errors['digit']">
                {{ !password.errors['digit'] ? '✅' : '❌' }} Un chiffre (0-9)
              </div>
              
              <div class="requirement-item" 
                   [class.valid]="!password.errors['specialChar']"
                   [class.invalid]="password.errors['specialChar']">
                {{ !password.errors['specialChar'] ? '✅' : '❌' }} Un caractère spécial (!&#64;#$%...)
              </div>
            </div>
  
          </nz-form-control>
        </nz-form-item>
  
        <!-- Confirmation mot de passe -->
        <nz-form-item>
          <nz-form-label nzRequired>Confirmer le mot de passe</nz-form-label>
          <nz-form-control [nzValidateStatus]="password_confirmation.invalid && password_confirmation.touched ? 'error' : ''">
            
            <nz-input-group nzSuffix>
              <input
                [type]="confirmPasswordVisible ? 'text' : 'password'"
                nz-input
                placeholder="Confirmez votre nouveau mot de passe"
                formControlName="password_confirmation"
                class="password-input">
              <span 
                nz-input-group-slot="suffix"
                (click)="toggleConfirmPasswordVisibility()"
                class="password-toggle">
                {{ confirmPasswordVisible ? '👁️' : '👁️‍🗨️' }}
              </span>
            </nz-input-group>
            
            <!-- Messages d'erreur confirmation -->
            <div *ngIf="password_confirmation.hasError('required') && password_confirmation.touched" class="error-message">
              La confirmation est requise
            </div>
            <div *ngIf="password_confirmation.hasError('passwordMismatch') && password_confirmation.touched" class="error-message">
              Les mots de passe ne correspondent pas
            </div>
  
          </nz-form-control>
        </nz-form-item>
  
        <!-- Bouton de soumission -->
        <nz-form-item class="submit-button">
          <nz-form-control>
            <button 
              nz-button 
              nzType="primary" 
              nzSize="large"
              nzBlock
              [nzLoading]="isLoading"
              [disabled]="resetForm.invalid || !token"
              class="reset-btn">
              🔐 {{ isLoading ? 'Réinitialisation...' : 'Réinitialiser le mot de passe' }}
            </button>
          </nz-form-control>
        </nz-form-item>
      </form>
  
      <!-- Footer -->
      <div class="footer">
        <a (click)="goToLogin()" class="back-link">
          ← Retour à la connexion
        </a>
      </div>
    </div>
  </div>