import{a as zt}from"./chunk-27NBWDSI.js";import{a as gt,b as ft}from"./chunk-HTLBF6DE.js";import{a as xt,b as vt,c as Ct}from"./chunk-PELTZT2M.js";import{a as _t,b as ht}from"./chunk-CVYSXDLY.js";import"./chunk-Y7M66OUD.js";import{a as qe,b as Xe,c as He}from"./chunk-OGA5CNRD.js";import{a as it,b as ot,c as rt,d as at,e as st}from"./chunk-BNFSWPKA.js";import{a as et,b as tt,c as nt}from"./chunk-LJV24WEU.js";import{a as oe}from"./chunk-6YN3NGFY.js";import{a as pt,b as ut}from"./chunk-R6I3ZYWE.js";import{b as me,c as pe,d as ue}from"./chunk-2CDAYGND.js";import"./chunk-LBGCJ5DM.js";import{a as Je,b as Ye,c as Ke,e as Qe}from"./chunk-CGU7QHHX.js";import{e as Ze}from"./chunk-7SAAJH44.js";import{a as re,b as ae}from"./chunk-4KCKLZTT.js";import{a as dt,b as mt}from"./chunk-Z7HGAQMR.js";import{a as Ee,b as Pe,c as ye,d as Me,e as Oe,f as Te,g as De,h as Ne,i as ke,j as Le,l as Ae,m as $e,n as Be,o as We,p as je}from"./chunk-ZFV5NHAD.js";import{a as Ue,b as we}from"./chunk-VWKRELSZ.js";import"./chunk-E44DIQ7Z.js";import"./chunk-OSEQ4WIA.js";import{a as Re,b as Ge}from"./chunk-5HO2BJJL.js";import{c as ee,e as te,f as ne,g as ie}from"./chunk-6XHWMXPL.js";import{d as lt,e as ct}from"./chunk-66NTQKWN.js";import"./chunk-WVDIGHRG.js";import{a as Fe,b as Ie,c as Ve}from"./chunk-V73OBEQV.js";import"./chunk-WGMYJEJ4.js";import"./chunk-465NLBOU.js";import{a as se,b as le,d as ce,f as de}from"./chunk-IXUSDIY2.js";import"./chunk-CZTCGH7Y.js";import{A as be,B as Se,d as ge,e as P,g as fe,h as _e,m as he,n as ze,q as xe,r as ve,z as Ce}from"./chunk-XBYNCXSQ.js";import"./chunk-DST4DQF7.js";import{qa as Q,sa as Z}from"./chunk-PYGBBRX5.js";import{a as F}from"./chunk-PJQGREK5.js";import"./chunk-4FK3KGSF.js";import"./chunk-PA5JYGXZ.js";import"./chunk-HPXRSP2X.js";import"./chunk-YLHBJJO7.js";import{A as K,s as J,t as Y}from"./chunk-H734YLDB.js";import{Aa as _,Ab as q,Ac as b,Bb as M,E as B,H as W,M as j,Mb as n,Nb as i,Ob as m,Pb as L,Qb as A,Sb as x,Y as y,Yb as z,_ as R,_b as u,ab as T,f as k,fb as r,gb as D,gc as v,hc as l,ic as E,jc as h,kc as X,mc as U,n as $,nc as w,oa as G,oc as O,qc as H,rc as S,vb as g,za as f,zb as c}from"./chunk-EIVDWLNO.js";import{a as V,b as N}from"./chunk-4CLCTAJ7.js";var St=()=>({color:"#1890ff"}),Et=()=>({color:"#52c41a"}),Pt=()=>({color:"#fa8c16"}),yt=()=>[5,10,20,50],Mt=()=>({x:"1280px"}),I=()=>({padding:"12px"});function Ut(o,t){if(o&1){let e=x();n(0,"button",44),z("click",function(){f(e);let s=u();return _(s.refresh())}),m(1,"span",45),l(2," Actualiser "),i()}if(o&2){let e=u();c("nzLoading",e.loading)}}function wt(o,t){o&1&&m(0,"span",46)}function Ot(o,t){if(o&1){let e=x();n(0,"span",48),z("click",function(){f(e);let s=u(2);return _(s.clearSearch())}),i()}}function Tt(o,t){if(o&1&&g(0,Ot,1,0,"span",47),o&2){let e=u();c("ngIf",e.searchTerm)}}function Dt(o,t){if(o&1&&(n(0,"span")(1,"a",52),l(2),i()()),o&2){let e=u().$implicit;r(),c("href","tel:"+e.telephone,T),r(),E(e.telephone)}}function Ft(o,t){o&1&&(n(0,"span",66),l(1,"-"),i())}function It(o,t){if(o&1&&(n(0,"span"),l(1),i()),o&2){let e=u().$implicit;r(),E(e.poste)}}function Vt(o,t){o&1&&(n(0,"span",66),l(1,"-"),i())}function Nt(o,t){if(o&1&&(n(0,"span"),l(1),i()),o&2){let e=u().$implicit;r(),E(e.service)}}function kt(o,t){o&1&&(n(0,"span",66),l(1,"-"),i())}function Lt(o,t){if(o&1&&(n(0,"span",56),l(1),i()),o&2){let e=u().$implicit,a=u();r(),h(" ",a.formatDate(e.derniere_connexion)," ")}}function At(o,t){o&1&&(n(0,"span",66),l(1,"Jamais connect\xE9"),i())}function $t(o,t){if(o&1&&(n(0,"button",67),m(1,"span",68),i()),o&2){u();let e=v(44);c("nzDropdownMenu",e)}}function Bt(o,t){if(o&1){let e=x();n(0,"tr")(1,"td",49)(2,"div",50)(3,"nz-avatar",51),z("click",function(){let s=f(e).$implicit,p=u();return _(p.viewUserPhoto(s))}),i()()(),n(4,"td")(5,"strong"),l(6),i()(),n(7,"td"),l(8),i(),n(9,"td")(10,"a",52),l(11),i()(),n(12,"td"),g(13,Dt,3,2,"span",53)(14,Ft,2,0,"ng-template",null,3,b),i(),n(16,"td"),g(17,It,2,1,"span",53)(18,Vt,2,0,"ng-template",null,4,b),i(),n(20,"td"),g(21,Nt,2,1,"span",53)(22,kt,2,0,"ng-template",null,5,b),i(),n(24,"td")(25,"nz-tag",54),l(26),i()(),n(27,"td")(28,"nz-tag",54),l(29),i()(),n(30,"td",55)(31,"span",56),l(32),i()(),n(33,"td",55),g(34,Lt,2,1,"span",57)(35,At,2,0,"ng-template",null,6,b),i(),n(37,"td",49)(38,"nz-tag",54),l(39),i()(),n(40,"td",58)(41,"nz-space",59),g(42,$t,2,1,"button",60),i(),n(43,"nz-dropdown-menu",null,7)(45,"ul",61)(46,"li",62),z("click",function(){let s=f(e).$implicit,p=u();return _(p.editUser(s))}),m(47,"span",63),l(48," Modifier "),i(),n(49,"li",62),z("click",function(){let s=f(e).$implicit,p=u();return _(p.toggleUserStatus(s))}),m(50,"span",64),l(51," Changer statut "),i(),m(52,"li",65),i()()()()}if(o&2){let e=t.$implicit,a=v(15),s=v(19),p=v(23),d=v(36),C=u();r(3),q("cursor",C.getUserPhotoUrl(e)?"pointer":"default"),c("nzSize",40)("nzSrc",C.getUserPhotoUrl(e))("nzIcon","user")("nzShape","circle"),r(3),E(e.nom),r(2),E(e.prenom),r(2),c("href","mailto:"+e.email,T),r(),E(e.email),r(2),c("ngIf",e.telephone)("ngIfElse",a),r(4),c("ngIf",e.poste)("ngIfElse",s),r(4),c("ngIf",e.service)("ngIfElse",p),r(4),c("nzColor",C.getUserTypeColor(e.type)),r(),h(" ",C.getUserTypeLabel(e.type)," "),r(2),c("nzColor",C.getStatusColor(e.statut_utilisateur)),r(),h(" ",C.getStatusLabel(e.statut_utilisateur)," "),r(3),E(C.formatDate(e.date_inscription)),r(2),c("ngIf",e.derniere_connexion)("ngIfElse",d),r(4),c("nzColor",C.getAdminColor(e)),r(),h(" ",C.getAdminLabel(e)," ")}}function Wt(o,t){o&1&&m(0,"span",74)}function jt(o,t){if(o&1&&(n(0,"span",75),l(1),i()),o&2){let e=u(2);r(),h(' Aucun utilisateur trouv\xE9 pour "',e.searchTerm,'" ')}}function Rt(o,t){if(o&1){let e=x();n(0,"button",76),z("click",function(){f(e);let s=u(2);return _(s.clearSearch())}),l(1," Effacer la recherche "),i()}}function Gt(o,t){o&1&&(n(0,"div",69)(1,"nz-space",70),g(2,Wt,1,0,"span",71)(3,jt,2,1,"span",72)(4,Rt,2,0,"button",73),i()())}function qt(o,t){o&1&&m(0,"span",81)}function Xt(o,t){o&1&&(n(0,"span",82),l(1," Aucun utilisateur trouv\xE9 "),i())}function Ht(o,t){if(o&1){let e=x();n(0,"button",83),z("click",function(){f(e);let s=u(2);return _(s.refresh())}),l(1," Actualiser "),i()}}function Jt(o,t){o&1&&(n(0,"div",77)(1,"nz-space",70),g(2,qt,1,0,"span",78)(3,Xt,2,0,"span",79)(4,Ht,2,0,"button",80),i()())}function Yt(o,t){if(o&1&&m(0,"nz-option",129),o&2){let e=t.$implicit;c("nzValue",e.value)("nzLabel",e.label)}}function Kt(o,t){if(o&1&&m(0,"nz-option",129),o&2){let e=t.$implicit;c("nzValue",e.value)("nzLabel",e.label)}}function Qt(o,t){if(o&1){let e=x();n(0,"button",130),z("click",function(){f(e);let s=u(2);return _(s.viewDocument(s.carteProf))}),m(1,"span",131),i()}}function Zt(o,t){if(o&1&&(n(0,"div",132)(1,"div",133),l(2),i(),n(3,"div",134),l(4),i(),n(5,"div",135)(6,"nz-tag",136),l(7),i()()()),o&2){let e=u(2);r(2),h(" ",e.formatFileSize(e.carteProf.taille_fichier)," "),r(2),h(" ",e.formatDate(e.carteProf.date_telechargement)," "),r(2),c("nzColor",e.carteProf.statut_document==="actif"?"green":"orange"),r(),h(" ",e.carteProf.statut_document," ")}}function en(o,t){o&1&&(n(0,"div",137),m(1,"span",138),l(2," Non fournie "),i())}function tn(o,t){if(o&1){let e=x();n(0,"button",130),z("click",function(){f(e);let s=u(2);return _(s.viewDocument(s.cniDoc))}),m(1,"span",131),i()}}function nn(o,t){if(o&1&&(n(0,"div",132)(1,"div",133),l(2),i(),n(3,"div",134),l(4),i(),n(5,"div",135)(6,"nz-tag",136),l(7),i()()()),o&2){let e=u(2);r(2),h(" ",e.formatFileSize(e.cniDoc.taille_fichier)," "),r(2),h(" ",e.formatDate(e.cniDoc.date_telechargement)," "),r(2),c("nzColor",e.cniDoc.statut_document==="actif"?"green":"orange"),r(),h(" ",e.cniDoc.statut_document," ")}}function on(o,t){o&1&&(n(0,"div",137),m(1,"span",138),l(2," Non fournie "),i())}function rn(o,t){if(o&1){let e=x();n(0,"button",130),z("click",function(){f(e);let s=u(2);return _(s.viewDocument(s.photoProfilDoc))}),m(1,"span",131),i()}}function an(o,t){if(o&1&&(n(0,"div",139)(1,"div",140),m(2,"img",141),i(),n(3,"div",142),l(4," Nouvelle photo s\xE9lectionn\xE9e "),i()()),o&2){let e=u(2);r(2),c("src",e.editPhotoProfilPreview,T)}}function sn(o,t){if(o&1&&(n(0,"div",132)(1,"div",133),l(2),i(),n(3,"div",134),l(4),i(),n(5,"div",135)(6,"nz-tag",136),l(7),i()()()),o&2){let e=u(2);r(2),h(" ",e.formatFileSize(e.photoProfilDoc.taille_fichier)," "),r(2),h(" ",e.formatDate(e.photoProfilDoc.date_telechargement)," "),r(2),c("nzColor",e.photoProfilDoc.statut_document==="actif"?"green":"orange"),r(),h(" ",e.photoProfilDoc.statut_document," ")}}function ln(o,t){o&1&&(n(0,"div",143),m(1,"span",144),l(2," Non fournie "),i())}function cn(o,t){if(o&1){let e=x();n(0,"button",130),z("click",function(){f(e);let s=u(2);return _(s.viewDocument(s.ficheSouscriptionDoc))}),m(1,"span",131),i()}}function dn(o,t){if(o&1&&(n(0,"div",132)(1,"div",133),l(2),i(),n(3,"div",134),l(4),i(),n(5,"div",135)(6,"nz-tag",136),l(7),i()()()),o&2){let e=u(2);r(2),h(" ",e.formatFileSize(e.ficheSouscriptionDoc.taille_fichier)," "),r(2),h(" ",e.formatDate(e.ficheSouscriptionDoc.date_telechargement)," "),r(2),c("nzColor",e.ficheSouscriptionDoc.statut_document==="actif"?"green":"orange"),r(),h(" ",e.ficheSouscriptionDoc.statut_document," ")}}function mn(o,t){o&1&&(n(0,"div",137),m(1,"span",138),l(2," Non fournie "),i())}function pn(o,t){if(o&1&&(L(0),n(1,"form",84)(2,"div",85)(3,"div",86)(4,"nz-form-item")(5,"nz-form-label",87),l(6,"Nom"),i(),n(7,"nz-form-control",88),m(8,"input",89),i()()(),n(9,"div",86)(10,"nz-form-item")(11,"nz-form-label",87),l(12,"Pr\xE9nom"),i(),n(13,"nz-form-control",88),m(14,"input",90),i()()()(),n(15,"nz-form-item")(16,"nz-form-label",87),l(17,"Email"),i(),n(18,"nz-form-control",88),m(19,"input",91),i()(),n(20,"div",85)(21,"div",86)(22,"nz-form-item")(23,"nz-form-label"),l(24,"T\xE9l\xE9phone"),i(),n(25,"nz-form-control"),m(26,"input",92),i()()(),n(27,"div",86)(28,"nz-form-item")(29,"nz-form-label"),l(30,"Poste"),i(),n(31,"nz-form-control"),m(32,"input",93),i()()()(),n(33,"nz-form-item")(34,"nz-form-label"),l(35,"Service"),i(),n(36,"nz-form-control"),m(37,"input",94),i()(),n(38,"div",85)(39,"div",86)(40,"nz-form-item")(41,"nz-form-label",87),l(42,"Type d'utilisateur"),i(),n(43,"nz-form-control",88)(44,"nz-select",95),g(45,Yt,1,2,"nz-option",96),i()()()(),n(46,"div",86)(47,"nz-form-item")(48,"nz-form-label",87),l(49,"Statut"),i(),n(50,"nz-form-control",88)(51,"nz-select",97),g(52,Kt,1,2,"nz-option",96),i()()()()(),n(53,"nz-form-item")(54,"nz-form-control")(55,"label",98),l(56," Droits d'administrateur "),i()()(),n(57,"div",99)(58,"h4",100),m(59,"span",101),l(60," Documents de l'utilisateur "),i(),n(61,"div",85)(62,"div",102)(63,"nz-card",103)(64,"div",104)(65,"div",105)(66,"div",106),m(67,"span",107),l(68," Carte Professionnelle "),i(),n(69,"div",108),g(70,Qt,2,0,"button",109),n(71,"nz-upload",110)(72,"button",111),m(73,"span",112),i()()()(),g(74,Zt,8,4,"div",113)(75,en,3,0,"ng-template",null,8,b),i()()(),n(77,"div",102)(78,"nz-card",103)(79,"div",104)(80,"div",105)(81,"div",114),m(82,"span",115),l(83," CNI "),i(),n(84,"div",108),g(85,tn,2,0,"button",109),n(86,"nz-upload",110)(87,"button",111),m(88,"span",112),i()()()(),g(89,nn,8,4,"div",113)(90,on,3,0,"ng-template",null,9,b),i()()(),n(92,"div",102)(93,"nz-card",116)(94,"div",104)(95,"div",105)(96,"div",117),m(97,"span",118),l(98," Photo de Profil "),i(),n(99,"div",108),g(100,rn,2,0,"button",109),n(101,"nz-upload",119)(102,"button",111),m(103,"span",112),i()()()(),n(104,"div",120)(105,"div",121),m(106,"nz-avatar",122),i(),n(107,"div",123),l(108),i()(),g(109,an,5,1,"div",124)(110,sn,8,4,"div",113)(111,ln,3,0,"ng-template",null,10,b),i()()(),n(113,"div",102)(114,"nz-card",103)(115,"div",104)(116,"div",105)(117,"div",125),m(118,"span",126),l(119," Fiche Souscription "),i(),n(120,"div",108),g(121,cn,2,0,"button",109),n(122,"nz-upload",110)(123,"button",111),m(124,"span",112),i()()()(),g(125,dn,8,4,"div",113)(126,mn,3,0,"ng-template",null,11,b),i()()()(),n(128,"div",127),m(129,"nz-alert",128),i()()(),A()),o&2){let e=v(76),a=v(91),s=v(112),p=v(127),d=u();r(),c("formGroup",d.editForm),r(),c("nzGutter",16),r(5),c("nzErrorTip",d.getFieldError("nom")),r(),M("error-input",d.isFieldInvalid("nom")),r(5),c("nzErrorTip",d.getFieldError("prenom")),r(),M("error-input",d.isFieldInvalid("prenom")),r(4),c("nzErrorTip",d.getFieldError("email")),r(),M("error-input",d.isFieldInvalid("email")),r(),c("nzGutter",16),r(18),c("nzGutter",16),r(5),c("nzErrorTip",d.getFieldError("type")),r(),M("error-input",d.isFieldInvalid("type")),r(),c("ngForOf",d.userTypeOptions),r(5),c("nzErrorTip",d.getFieldError("statut_utilisateur")),r(),M("error-input",d.isFieldInvalid("statut_utilisateur")),r(),c("ngForOf",d.statusOptions),r(9),c("nzGutter",16),r(2),c("nzBodyStyle",S(52,I)),r(7),c("ngIf",d.carteProf),r(),c("nzBeforeUpload",d.beforeUploadEditCartePro)("nzShowUploadList",!1),r(3),c("ngIf",d.carteProf)("ngIfElse",e),r(4),c("nzBodyStyle",S(53,I)),r(7),c("ngIf",d.cniDoc),r(),c("nzBeforeUpload",d.beforeUploadEditCni)("nzShowUploadList",!1),r(3),c("ngIf",d.cniDoc)("ngIfElse",a),r(4),c("nzBodyStyle",S(54,I)),r(7),c("ngIf",d.photoProfilDoc),r(),c("nzBeforeUpload",d.beforeUploadEditPhotoProfil)("nzShowUploadList",!1),r(5),c("nzSize",80)("nzSrc",d.getCurrentPhotoUrl())("nzIcon","user")("nzShape","circle"),r(2),h(" ",d.getCurrentPhotoUrl()?"Photo actuelle":"Aucune photo"," "),r(),c("ngIf",d.editPhotoProfilPreview),r(),c("ngIf",d.photoProfilDoc)("ngIfElse",s),r(4),c("nzBodyStyle",S(55,I)),r(7),c("ngIf",d.ficheSouscriptionDoc),r(),c("nzBeforeUpload",d.beforeUploadEditFicheSouscription)("nzShowUploadList",!1),r(3),c("ngIf",d.ficheSouscriptionDoc)("ngIfElse",p)}}function un(o,t){if(o&1&&(n(0,"div",152)(1,"h4"),m(2,"span",153),l(3),i(),n(4,"p",154),l(5," Statut actuel : "),n(6,"nz-tag",54),l(7),i()()()),o&2){let e=u(2);r(3),X(" ",e.selectedUserForStatus.prenom," ",e.selectedUserForStatus.nom," "),r(3),c("nzColor",e.getStatusColor(e.selectedUserForStatus.statut_utilisateur)),r(),h(" ",e.getStatusLabel(e.selectedUserForStatus.statut_utilisateur)," ")}}function gn(o,t){if(o&1&&(n(0,"label",155)(1,"nz-tag",156),l(2),i()()),o&2){let e=t.$implicit,a=u(2);c("nzValue",e.value),r(),c("nzColor",a.getStatusColor(e.value)),r(),h(" ",e.label," ")}}function fn(o,t){o&1&&m(0,"nz-alert",157)}function _n(o,t){o&1&&m(0,"nz-alert",158)}function hn(o,t){if(o&1){let e=x();L(0),n(1,"div",145),g(2,un,8,4,"div",146),m(3,"nz-divider"),n(4,"div",147)(5,"h5"),l(6,"Nouveau statut :"),i(),n(7,"nz-radio-group",148),O("ngModelChange",function(s){f(e);let p=u();return w(p.newStatus,s)||(p.newStatus=s),_(s)}),g(8,gn,3,3,"label",149),i()(),g(9,fn,1,0,"nz-alert",150)(10,_n,1,0,"nz-alert",151),i(),A()}if(o&2){let e=u();r(2),c("ngIf",e.selectedUserForStatus),r(5),U("ngModel",e.newStatus),r(),c("ngForOf",e.statusOptions),r(),c("ngIf",e.newStatus==="suspendu"),r(),c("ngIf",e.newStatus==="inactif")}}function zn(o,t){if(o&1){let e=x();n(0,"div",160)(1,"div",161)(2,"nz-descriptions",162)(3,"nz-descriptions-item",163),l(4),i(),n(5,"nz-descriptions-item",164),l(6),i(),n(7,"nz-descriptions-item",165),l(8),i(),n(9,"nz-descriptions-item",166),l(10),i(),n(11,"nz-descriptions-item",167)(12,"nz-tag",54),l(13),i()()()(),n(14,"div",168)(15,"div",169)(16,"img",170),z("error",function(s){f(e);let p=u(2);return _(p.onImageError(s))}),i(),n(17,"div",171),m(18,"span",172),n(19,"p"),l(20,"Aper\xE7u non disponible"),i(),n(21,"p",173),l(22),i()()()()()}if(o&2){let e=u(2);r(2),c("nzBordered",!0)("nzColumn",2),r(2),h(" ",e.selectedDocument.nom_original," "),r(2),h(" ",e.formatFileSize(e.selectedDocument.taille_fichier)," "),r(2),h(" ",e.formatDate(e.selectedDocument.date_telechargement)," "),r(2),h(" v",e.selectedDocument.version_document," "),r(2),c("nzColor",e.selectedDocument.statut_document==="actif"?"green":"orange"),r(),h(" ",e.selectedDocument.statut_document," "),r(3),c("src",e.getDocumentUrl(e.selectedDocument),T)("alt",e.selectedDocument.nom_original),r(6),E(e.selectedDocument.nom_original)}}function xn(o,t){if(o&1&&(n(0,"div"),g(1,zn,23,11,"div",159),i()),o&2){let e=u();r(),c("ngIf",e.selectedDocument)}}var bt=class o{constructor(t,e,a,s){this.authService=t;this.fb=e;this.message=a;this.notification=s;this.initEditForm()}users=[];filteredUsers=[];loading=!1;currentPage=1;pageSize=10;totalItems=0;searchTerm="";searchSubject=new k;destroy$=new k;totalUsers=0;totalAdmins=0;totalRegularUsers=0;isEditModalVisible=!1;editForm;editingUser=null;isEditLoading=!1;isStatusModalVisible=!1;selectedUserForStatus=null;newStatus="actif";isStatusLoading=!1;editUserDocuments=null;isDocumentModalVisible=!1;selectedDocument=null;editUploadFiles={};editPhotoProfilPreview=null;statusOptions=[{label:"Actif",value:"actif"},{label:"Suspendu",value:"suspendu"},{label:"Inactif",value:"inactif"}];userTypeOptions=[{label:"Utilisateur",value:"user"},{label:"Administrateur",value:"admin"},{label:"Super Admin",value:"superAdmin"}];ngOnInit(){this.setupSearch(),this.loadUsers()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initEditForm(){this.editForm=this.fb.group({nom:["",[P.required,P.minLength(2)]],prenom:["",[P.required,P.minLength(2)]],email:["",[P.required,P.email]],telephone:[""],poste:[""],service:[""],type:["",P.required],est_administrateur:[!1],statut_utilisateur:["",P.required]})}setupSearch(){this.searchSubject.pipe(W(300),j(),y(this.destroy$)).subscribe(t=>{console.log("\u{1F50D} Recherche:",t),this.searchTerm=t,this.currentPage=1,this.applyFiltersAndPagination()})}onSearchChange(t){this.searchSubject.next(t)}onPageChange(t){console.log("\u{1F4C4} Changement de page:",t),this.currentPage=t,this.applyFiltersAndPagination()}onPageSizeChange(t){console.log("\u{1F4C4} Changement taille page:",t),this.pageSize=t,this.currentPage=1,this.applyFiltersAndPagination()}loadUsers(){console.log("\u{1F4CB} Chargement des utilisateurs..."),this.loading=!0,this.authService.getAllUsers().pipe(R(t=>{console.log("\u2705 Utilisateurs r\xE9cup\xE9r\xE9s:",t),console.log("\u{1F4CA} Nombre d'utilisateurs:",t.length)}),B(t=>(console.error("\u274C Erreur lors du chargement des utilisateurs:",t),this.message.error("Erreur lors du chargement des utilisateurs"),this.loading=!1,$([]))),y(this.destroy$)).subscribe({next:t=>{this.users=t,this.calculateStatistics(),this.applyFiltersAndPagination(),this.loading=!1},error:t=>{console.error("\u274C Erreur lors du chargement des utilisateurs:",t),this.users=[],this.filteredUsers=[],this.totalItems=0,this.resetStatistics(),this.loading=!1}})}calculateStatistics(){this.totalUsers=this.users.length,this.totalAdmins=this.users.filter(t=>this.isAdmin(t)).length,this.totalRegularUsers=this.users.filter(t=>!this.isAdmin(t)).length,console.log("\u{1F4CA} Statistiques calcul\xE9es:",{total:this.totalUsers,admins:this.totalAdmins,users:this.totalRegularUsers})}resetStatistics(){this.totalUsers=0,this.totalAdmins=0,this.totalRegularUsers=0}applyFiltersAndPagination(){if(console.log("\u{1F504} Application des filtres et pagination..."),this.searchTerm&&this.searchTerm.trim()){let t=this.searchTerm.toLowerCase().trim();this.filteredUsers=this.users.filter(e=>{let a=e.nom?.toLowerCase().includes(t)||!1,s=e.prenom?.toLowerCase().includes(t)||!1,p=e.email?.toLowerCase().includes(t)||!1,d=e.matricule?.toLowerCase().includes(t)||!1,C=e.telephone?.includes(t)||!1;return a||s||p||d||C}),console.log("\u{1F50D} Filtrage appliqu\xE9. R\xE9sultats:",this.filteredUsers.length)}else this.filteredUsers=[...this.users],console.log("\u{1F4CB} Aucun filtre. Tous les utilisateurs:",this.filteredUsers.length);this.totalItems=this.filteredUsers.length,console.log("\u{1F4C4} Pagination mise \xE0 jour:",{page:this.currentPage,pageSize:this.pageSize,total:this.totalItems})}getPaginatedUsers(){let t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredUsers.slice(t,e)}refresh(){console.log("\u{1F504} Rafra\xEEchissement des utilisateurs..."),this.loadUsers()}clearSearch(){console.log("\u{1F9F9} R\xE9initialisation de la recherche..."),this.searchTerm="",this.currentPage=1,this.applyFiltersAndPagination()}editUser(t){console.log("\u270F\uFE0F Modifier utilisateur:",t),this.isEditLoading=!0,this.authService.getUserProfile(t.id_utilisateur).pipe(y(this.destroy$)).subscribe({next:e=>{console.log("\u{1F464} Profil utilisateur r\xE9cup\xE9r\xE9:",e),this.editingUser=e.data,this.populateEditForm(e.data),this.loadUserDocuments(e.data),this.isEditModalVisible=!0,this.isEditLoading=!1},error:e=>{console.error("\u274C Erreur r\xE9cup\xE9ration profil:",e),this.message.error("Erreur lors de la r\xE9cup\xE9ration du profil utilisateur"),this.isEditLoading=!1}})}populateEditForm(t){console.log("\u{1F50D} Type actuel de l'utilisateur:",t.type),console.log("\u{1F50D} Valeurs disponibles:",this.userTypeOptions),this.editForm.patchValue({nom:t.nom,prenom:t.prenom,email:t.email,telephone:t.telephone||"",poste:t.poste||"",service:t.service||"",type:t.type,est_administrateur:t.est_administrateur,statut_utilisateur:t.statut_utilisateur})}submitEdit(){if(this.editForm.valid&&this.editingUser){this.isEditLoading=!0;let t=this.editForm.value;console.log("\u{1F4DD} Donn\xE9es \xE0 modifier (avant correction):",t),console.log("\u{1F4DD} Type de est_administrateur avant:",typeof t.est_administrateur);let e=N(V({},t),{est_administrateur:!!t.est_administrateur});if(console.log("\u{1F4DD} Donn\xE9es corrig\xE9es:",e),console.log("\u{1F4DD} Type de est_administrateur apr\xE8s:",typeof e.est_administrateur),!this.userTypeOptions.map(s=>s.value).includes(e.type)){console.error("\u274C Type invalide:",e.type),this.message.error("Type d'utilisateur invalide"),this.isEditLoading=!1;return}this.authService.updateUserProfile(this.editingUser.id_utilisateur,e).pipe(y(this.destroy$)).subscribe({next:s=>{console.log("\u2705 Utilisateur modifi\xE9 avec succ\xE8s:",s),this.message.success("Utilisateur modifi\xE9 avec succ\xE8s"),this.isEditLoading=!1,this.closeEditModal(),this.loadUsers()},error:s=>{console.error("\u274C Erreur modification utilisateur:",s),this.handleFormError(s),this.isEditLoading=!1}})}else this.handleInvalidForm()}submitEditWithDocuments(){if(this.editForm.valid&&this.editingUser){this.isEditLoading=!0;let t=new FormData,e=this.editForm.value;console.log("\u{1F4DD} Valeurs formulaire avant traitement:",e),Object.keys(e).forEach(a=>{if(e[a]!==null&&e[a]!==void 0){let s=e[a];if(a==="est_administrateur"){let p=!!s;s=p.toString(),console.log(`\u{1F4CE} Conversion ${a}: ${e[a]} \u2192 ${p} \u2192 "${s}" (${typeof s})`)}t.append(a,s)}}),Object.keys(this.editUploadFiles).forEach(a=>{let s=this.editUploadFiles[a];s&&(t.append(a,s),console.log(`\u{1F4CE} Ajout du fichier ${a}:`,s.name))}),console.log("\u{1F4DD} Envoi des donn\xE9es de modification avec la nouvelle API POST..."),this.authService.updateUserWithFormData(this.editingUser.id_utilisateur,t).pipe(y(this.destroy$)).subscribe({next:a=>{console.log("\u2705 Utilisateur modifi\xE9 avec succ\xE8s via POST:",a),this.handleSuccessfulUpdate(a)},error:a=>{console.error("\u274C Erreur modification utilisateur via POST:",a),this.handleFormError(a)}})}else this.handleInvalidForm()}handleFormError(t){if(console.error("\u{1F4CB} D\xE9tail de l'erreur:",t),t.error&&t.error.errors){let e=t.error.errors;console.error("\u{1F4CB} Erreurs de validation:",e);let a=Object.keys(e).map(s=>{let p=Array.isArray(e[s])?e[s]:[e[s]];return`${s}: ${p.join(", ")}`}).join(" | ");this.message.error(`Erreurs de validation: ${a}`)}else t.error&&t.error.message?this.message.error(t.error.message):this.message.error("Erreur lors de la modification de l'utilisateur");this.isEditLoading=!1}closeEditModal(){this.isEditModalVisible=!1,this.editingUser=null,this.isEditLoading=!1,this.editForm.reset(),console.log("\u{1F6AA} Modal ferm\xE9e, loading arr\xEAt\xE9")}toggleUserStatus(t){console.log("\u{1F504} Changer statut utilisateur:",t),this.selectedUserForStatus=t,this.newStatus=t.statut_utilisateur,this.isStatusModalVisible=!0}confirmStatusChange(){if(this.selectedUserForStatus&&this.newStatus){this.isStatusLoading=!0;let t={statut_utilisateur:this.newStatus};console.log("\u{1F504} Changement de statut - Donn\xE9es \xE0 envoyer:",t),this.authService.updateUserProfile(this.selectedUserForStatus.id_utilisateur,t).pipe(y(this.destroy$)).subscribe({next:e=>{console.log("\u2705 Statut modifi\xE9 avec succ\xE8s:",e),this.message.success("Statut modifi\xE9 avec succ\xE8s"),this.closeStatusModal(),this.loadUsers()},error:e=>{console.error("\u274C Erreur changement statut:",e),this.handleFormError(e)}})}}closeStatusModal(){this.isStatusModalVisible=!1,this.selectedUserForStatus=null,this.newStatus="actif",this.isStatusLoading=!1}formatDate(t){if(!t)return"Non d\xE9finie";try{return new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Date invalide"}}getStatusLabel(t){switch(t?.toLowerCase()){case"actif":return"Actif";case"suspendu":return"Suspendu";case"inactif":return"Inactif";default:return t||"Non d\xE9fini"}}getStatusColor(t){switch(t?.toLowerCase()){case"actif":return"green";case"suspendu":return"orange";case"inactif":return"red";default:return"default"}}getUserTypeLabel(t){switch(t){case"superAdmin":return"Super Admin";case"admin":return"Administrateur";case"user":return"Utilisateur";default:return t||"Non d\xE9fini"}}getUserTypeColor(t){switch(t){case"superAdmin":return"purple";case"admin":return"orange";case"user":return"cyan";default:return"default"}}isAdmin(t){return t.est_administrateur||t.type==="superAdmin"||t.type==="admin"}getAdminLabel(t){let e=t.type;return e==="superAdmin"||e==="admin"?"Oui":"Non"}getAdminColor(t){let e=t.type;return e==="superAdmin"||e==="admin"?"green":"red"}viewUser(t){console.log("\u{1F441}\uFE0F Voir utilisateur:",t)}deleteUser(t){console.log("\u{1F5D1}\uFE0F Supprimer utilisateur:",t),this.message.info("Fonctionnalit\xE9 de suppression \xE0 impl\xE9menter")}isFieldInvalid(t){let e=this.editForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}getFieldError(t){let e=this.editForm.get(t);if(e&&e.errors){if(e.errors.required)return"Ce champ est obligatoire";if(e.errors.email)return"Format d'email invalide";if(e.errors.minlength)return`Minimum ${e.errors.minlength.requiredLength} caract\xE8res`}return""}trackByUserId(t,e){return e.id_utilisateur}getUserPhotoUrl(t){if(t.photo_profil&&t.photo_profil.chemin_fichier){let e=t.photo_profil.chemin_fichier.replace(/\\/g,"/");return`${F.storageUrl}/${e}`}}viewUserPhoto(t){if(t.photo_profil){let e=N(V({},t.photo_profil),{id_souscription:t.photo_profil.id_souscription??null,type_mime:t.photo_profil.type_mime??null});this.selectedDocument=e,this.isDocumentModalVisible=!0}}getCurrentPhotoUrl(){if(this.photoProfilDoc&&this.photoProfilDoc.chemin_fichier){let t=this.photoProfilDoc.chemin_fichier.replace(/\\/g,"/");return`${F.storageUrl}/${t}`}}loadUserDocuments(t){this.editUserDocuments={carte_professionnelle:t.carte_professionnelle||null,cni:t.cni||null,photo_profil:t.photo_profil||null,fiche_souscription:t.fiche_souscription||null},console.log("\u{1F4CB} Documents utilisateur charg\xE9s:",this.editUserDocuments)}get carteProf(){return this.editUserDocuments?.carte_professionnelle||null}get cniDoc(){return this.editUserDocuments?.cni||null}get photoProfilDoc(){return this.editUserDocuments?.photo_profil||null}get ficheSouscriptionDoc(){return this.editUserDocuments?.fiche_souscription||null}viewDocument(t){this.selectedDocument=t,this.isDocumentModalVisible=!0}closeDocumentModal(){this.isDocumentModalVisible=!1,this.selectedDocument=null}getDocumentUrl(t){if(!t||!t.chemin_fichier)return"";let e=t.chemin_fichier.replace(/\\/g,"/");return`${F.storageUrl}/${e}`}formatFileSize(t){if(t===0)return"0 Bytes";let e=1024,a=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,s)).toFixed(2))+" "+a[s]}onImageError(t){let e=t.target;e&&e.nextElementSibling&&(e.style.display="none",e.nextElementSibling.style.display="block")}beforeUploadEditCni=t=>{console.log("\u{1F504} beforeUploadEditCni appel\xE9 avec:",t);let e=t.originFileObj||t;return e?this.validateFileSize(e,"CNI")&&this.onEditFileChange(e,"cni"):console.error("\u274C Aucun fichier trouv\xE9 pour CNI"),!1};beforeUploadEditCartePro=t=>{console.log("\u{1F504} beforeUploadEditCartePro appel\xE9 avec:",t);let e=t.originFileObj||t;return e?this.validateFileSize(e,"Carte Professionnelle")&&this.onEditFileChange(e,"carte_professionnelle"):console.error("\u274C Aucun fichier trouv\xE9 pour Carte Pro"),!1};beforeUploadEditPhotoProfil=t=>{console.log("\u{1F504} beforeUploadEditPhotoProfil appel\xE9 avec:",t);let e=t.originFileObj||t;return e?this.validateFileSize(e,"Photo de Profil")&&(this.onEditFileChange(e,"photo_profil"),this.generatePhotoPreview(e)):console.error("\u274C Aucun fichier trouv\xE9 pour Photo Profil"),!1};beforeUploadEditFicheSouscription=t=>{console.log("\u{1F504} beforeUploadEditFicheSouscription appel\xE9 avec:",t);let e=t.originFileObj||t;return e?this.validateFileSize(e,"Fiche de Souscription")&&this.onEditFileChange(e,"fiche_souscription"):console.error("\u274C Aucun fichier trouv\xE9 pour Fiche Souscription"),!1};validateFileSize(t,e){return t.size>5242880?(this.message.error(`Le fichier ${e} est trop volumineux. Taille maximale: 5MB`),this.notification.error("Fichier trop volumineux",`Le fichier ${e} (${(t.size/1024/1024).toFixed(1)}MB) d\xE9passe la limite de 5MB.`),!1):!0}onEditFileChange(t,e){console.log(`\u{1F4CE} Fichier ${e} s\xE9lectionn\xE9:`,t.name),this.editUploadFiles[e]=t,this.message.success(`Fichier ${e} s\xE9lectionn\xE9: ${t.name}`),this.notification.success("Fichier s\xE9lectionn\xE9",`Le fichier ${e} sera mis \xE0 jour lors de l'enregistrement des modifications.`)}generatePhotoPreview(t){if(t&&t.type.startsWith("image/")){let e=new FileReader;e.onload=a=>{this.editPhotoProfilPreview=a.target.result,console.log("\u{1F4F8} Aper\xE7u de la photo g\xE9n\xE9r\xE9")},e.readAsDataURL(t)}}handleSuccessfulUpdate(t){let e=Object.keys(this.editUploadFiles).length,a=e>0?` et ${e} document(s)`:"";console.log("\u2705 Mise \xE0 jour r\xE9ussie, fermeture du modal et actualisation du tableau");let s=this.editingUser?.prenom||"L'utilisateur",p=this.editingUser?.nom||"",d=p?`${s} ${p}`:s;this.message.success(`Utilisateur${a} modifi\xE9${e>0?"s":""} avec succ\xE8s`),this.isEditLoading=!1,setTimeout(()=>{this.closeEditModalWithCleanup(),this.loadUsers(),console.log("\u{1F504} Tableau des utilisateurs actualis\xE9 apr\xE8s modification")},100)}handleUpdateError(t){if(console.error("\u274C D\xE9tail de l'erreur de mise \xE0 jour:",t),t.error&&t.error.errors){let e=t.error.errors;console.error("\u{1F4CB} Erreurs de validation:",e);let a=Object.keys(e).map(s=>{let p=Array.isArray(e[s])?e[s]:[e[s]];return`${s}: ${p.join(", ")}`}).join(" | ");this.message.error(`Erreurs de validation: ${a}`)}else t.error&&t.error.message?this.message.error(t.error.message):this.message.error("Erreur lors de la modification de l'utilisateur");this.isEditLoading=!1}handleInvalidForm(){console.log("\u274C Formulaire invalide"),Object.keys(this.editForm.controls).forEach(t=>{let e=this.editForm.get(t);e&&e.errors&&console.log(`\u274C Erreur ${t}:`,e.errors)}),this.message.warning("Veuillez remplir tous les champs obligatoires"),Object.keys(this.editForm.controls).forEach(t=>{this.editForm.get(t)?.markAsTouched()})}closeEditModalWithCleanup(){this.isEditModalVisible=!1,this.editingUser=null,this.editUserDocuments=null,this.editUploadFiles={},this.editPhotoProfilPreview=null,this.isEditLoading=!1,this.editForm.reset(),console.log("\u{1F6AA} Modal ferm\xE9e avec nettoyage des documents")}debugFormValues(){console.log("\u{1F50D} DIAGNOSTIC - Valeurs du formulaire:");let t=this.editForm.value;Object.keys(t).forEach(e=>{let a=t[e];console.log(`  ${e}: ${a} (type: ${typeof a})`),e==="est_administrateur"&&(console.log(`    \u2192 Bool\xE9en natif: ${!!a}`),console.log(`    \u2192 Cha\xEEne bool\xE9enne: "${(!!a).toString()}"`))}),console.log("\u{1F50D} \xC9tat des contr\xF4les du formulaire:"),Object.keys(this.editForm.controls).forEach(e=>{let a=this.editForm.get(e);a&&console.log(`  ${e}: valeur=${a.value}, valide=${a.valid}, erreurs=`,a.errors)})}static \u0275fac=function(e){return new(e||o)(D(oe),D(Ce),D(Ze),D(zt))};static \u0275cmp=G({type:o,selectors:[["app-users"]],standalone:!0,features:[H],decls:65,vars:42,consts:[["prefixIconSearch",""],["suffixIconClear",""],["userTable",""],["noPhone",""],["noPoste",""],["noService",""],["noLastConnection",""],["actionMenu","nzDropdownMenu"],["noCarteProf",""],["noCni",""],["noPhotoProfil",""],["noFicheSouscription",""],[1,"container"],["nz-row","",1,"stats-section",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","8","nzMd","8"],[1,"stat-card","total-users"],["nzTitle","Total Utilisateurs","nzPrefix","\u{1F465}",3,"nzValue","nzValueStyle"],[1,"stat-card","total-admins"],["nzTitle","Administrateurs","nzPrefix","\u{1F6E1}\uFE0F",3,"nzValue","nzValueStyle"],[1,"stat-card","total-regular-users"],["nzTitle","Utilisateurs Standards","nzPrefix","\u{1F464}",3,"nzValue","nzValueStyle"],[1,"controls-section"],[1,"controls-header"],["nz-button","","nzType","primary",3,"nzLoading","click",4,"nzSpaceItem"],[1,"filter-container"],[3,"nzPrefix","nzSuffix"],["nz-input","","placeholder","Rechercher par nom, pr\xE9nom, email, matricule ou t\xE9l\xE9phone...",1,"search-input",3,"ngModelChange","ngModel"],[1,"table-section"],["nzSize","middle","nzBordered","",3,"nzPageIndexChange","nzPageSizeChange","nzData","nzLoading","nzFrontPagination","nzTotal","nzPageSize","nzPageIndex","nzPageSizeOptions","nzShowSizeChanger","nzScroll"],["nzWidth","80px"],["nzWidth","120px"],["nzWidth","200px"],["nzWidth","160px"],["nzWidth","130px"],["nzWidth","100px"],["nzWidth","140px"],["nzWidth","70px","nzRight",""],[4,"ngFor","ngForOf","ngForTrackBy"],["class","no-results",4,"ngIf"],["class","no-data",4,"ngIf"],["nzTitle","Modifier l'utilisateur",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText","nzOkLoading","nzWidth"],[4,"nzModalContent"],["nzTitle","Changer le statut de l'utilisateur",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText","nzOkLoading","nzWidth"],[3,"nzVisibleChange","nzOnCancel","nzVisible","nzTitle","nzWidth","nzFooter"],["nz-button","","nzType","primary",3,"click","nzLoading"],["nz-icon","","nzType","reload"],["nz-icon","","nzType","search"],["nz-icon","","nzType","close-circle","class","clear-icon",3,"click",4,"ngIf"],["nz-icon","","nzType","close-circle",1,"clear-icon",3,"click"],[1,"text-center"],[1,"user-avatar-container"],[1,"user-avatar",3,"click","nzSize","nzSrc","nzIcon","nzShape"],[3,"href"],[4,"ngIf","ngIfElse"],[3,"nzColor"],[1,"date-column"],[1,"date-text"],["class","date-text",4,"ngIf","ngIfElse"],["nzRight",""],["nzSize","small"],["nz-button","","nzType","primary","nzSize","small","nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu",4,"nzSpaceItem"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","edit"],["nz-icon","","nzType","user-switch"],["nz-menu-divider",""],[1,"text-muted"],["nz-button","","nzType","primary","nzSize","small","nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","more"],[1,"no-results"],["nzDirection","vertical","nzAlign","center"],["nz-icon","","nzType","search","nzTheme","outline","class","no-results-icon",4,"nzSpaceItem"],["class","no-results-text",4,"nzSpaceItem"],["nz-button","","nzType","link",3,"click",4,"nzSpaceItem"],["nz-icon","","nzType","search","nzTheme","outline",1,"no-results-icon"],[1,"no-results-text"],["nz-button","","nzType","link",3,"click"],[1,"no-data"],["nz-icon","","nzType","user","nzTheme","outline","class","no-data-icon",4,"nzSpaceItem"],["class","no-data-text",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-icon","","nzType","user","nzTheme","outline",1,"no-data-icon"],[1,"no-data-text"],["nz-button","","nzType","primary",3,"click"],["nz-form","","nzLayout","vertical",3,"formGroup"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],["nzRequired",""],[3,"nzErrorTip"],["nz-input","","formControlName","nom","placeholder","Nom de famille"],["nz-input","","formControlName","prenom","placeholder","Pr\xE9nom"],["nz-input","","formControlName","email","placeholder","adresse@email.com","type","email"],["nz-input","","formControlName","telephone","placeholder","+225 XX XX XX XX"],["nz-input","","formControlName","poste","placeholder","Poste occup\xE9"],["nz-input","","formControlName","service","placeholder","Service/D\xE9partement"],["formControlName","type","nzPlaceHolder","S\xE9lectionner un type"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","statut_utilisateur","nzPlaceHolder","S\xE9lectionner un statut"],["nz-checkbox","","formControlName","est_administrateur"],[1,"documents-section",2,"margin-top","24px"],[2,"margin-bottom","16px","color","#434343","font-weight","600"],["nz-icon","","nzType","file-text",2,"margin-right","8px"],["nz-col","","nzXs","24","nzSm","12","nzMd","12"],["nzSize","small",1,"document-card",2,"height","140px","transition","all 0.3s ease",3,"nzBodyStyle"],[1,"document-content"],[1,"document-header",2,"display","flex","justify-content","between","align-items","center","margin-bottom","8px"],[1,"document-title",2,"font-weight","600","color","#1890ff"],["nz-icon","","nzType","idcard","nzTheme","outline",2,"margin-right","4px"],[1,"document-actions"],["nz-button","","nzType","text","nzSize","small","style","padding: 0 4px;",3,"click",4,"ngIf"],["nzAction","","nzAccept","image/*,.pdf",2,"display","inline-block","margin-left","4px",3,"nzBeforeUpload","nzShowUploadList"],["nz-button","","nzType","text","nzSize","small",2,"padding","0 4px"],["nz-icon","","nzType","upload","nzTheme","outline"],["class","document-info",4,"ngIf","ngIfElse"],[1,"document-title",2,"font-weight","600","color","#52c41a"],["nz-icon","","nzType","credit-card","nzTheme","outline",2,"margin-right","4px"],["nzSize","small",1,"document-card",2,"min-height","200px","transition","all 0.3s ease",3,"nzBodyStyle"],[1,"document-title",2,"font-weight","600","color","#722ed1"],["nz-icon","","nzType","user","nzTheme","outline",2,"margin-right","4px"],["nzAction","","nzAccept","image/*",2,"display","inline-block","margin-left","4px",3,"nzBeforeUpload","nzShowUploadList"],[1,"photo-preview-section",2,"margin-bottom","12px"],[1,"current-photo",2,"text-align","center","margin-bottom","8px"],[2,"border","3px solid #722ed1","box-shadow","0 4px 8px rgba(114, 46, 209, 0.2)",3,"nzSize","nzSrc","nzIcon","nzShape"],[2,"text-align","center","font-size","11px","color","#666"],["class","new-photo-preview","style","margin-bottom: 12px;",4,"ngIf"],[1,"document-title",2,"font-weight","600","color","#faad14"],["nz-icon","","nzType","file-text","nzTheme","outline",2,"margin-right","4px"],[2,"margin-top","16px"],["nzType","info","nzMessage","Information sur les documents","nzDescription","Cliquez sur l'ic\xF4ne \u0153il pour visualiser un document ou sur l'ic\xF4ne upload pour le remplacer. Formats accept\xE9s : Images (JPG, PNG, GIF) et PDF. Taille maximale : 5MB par fichier.","nzShowIcon","","nzSize","small"],[3,"nzValue","nzLabel"],["nz-button","","nzType","text","nzSize","small",2,"padding","0 4px",3,"click"],["nz-icon","","nzType","eye","nzTheme","outline"],[1,"document-info"],[1,"document-meta",2,"font-size","12px","color","#666"],[1,"document-date",2,"font-size","11px","color","#999"],[2,"margin-top","8px"],["nzSize","small",3,"nzColor"],[1,"document-empty",2,"color","#999","font-size","12px"],["nz-icon","","nzType","file-add","nzTheme","outline",2,"font-size","20px","color","#d9d9d9","display","block","margin-bottom","4px"],[1,"new-photo-preview",2,"margin-bottom","12px"],[2,"text-align","center","margin-bottom","8px"],["alt","Nouvelle photo",2,"width","60px","height","60px","border-radius","50%","object-fit","cover","border","2px solid #52c41a","box-shadow","0 2px 4px rgba(82, 196, 26, 0.3)",3,"src"],[2,"text-align","center","font-size","11px","color","#52c41a","font-weight","500"],[1,"document-empty",2,"color","#999","font-size","12px","text-align","center"],["nz-icon","","nzType","file-add","nzTheme","outline",2,"font-size","16px","color","#d9d9d9","display","block","margin-bottom","4px"],[1,"status-change-content"],["class","user-info",4,"ngIf"],[1,"status-selection"],[1,"status-radio-group",3,"ngModelChange","ngModel"],["nz-radio","","class","status-radio-option",3,"nzValue",4,"ngFor","ngForOf"],["nzType","warning","nzMessage","Attention","nzDescription","L'utilisateur ne pourra plus se connecter jusqu'\xE0 ce que son statut soit modifi\xE9.","nzShowIcon","","class","status-warning",4,"ngIf"],["nzType","error","nzMessage","Compte inactif","nzDescription","L'utilisateur sera compl\xE8tement d\xE9sactiv\xE9 et ne pourra plus acc\xE9der au syst\xE8me.","nzShowIcon","","class","status-warning",4,"ngIf"],[1,"user-info"],["nz-icon","","nzType","user"],[1,"current-status"],["nz-radio","",1,"status-radio-option",3,"nzValue"],[1,"status-tag",3,"nzColor"],["nzType","warning","nzMessage","Attention","nzDescription","L'utilisateur ne pourra plus se connecter jusqu'\xE0 ce que son statut soit modifi\xE9.","nzShowIcon","",1,"status-warning"],["nzType","error","nzMessage","Compte inactif","nzDescription","L'utilisateur sera compl\xE8tement d\xE9sactiv\xE9 et ne pourra plus acc\xE9der au syst\xE8me.","nzShowIcon","",1,"status-warning"],["class","document-modal-content",4,"ngIf"],[1,"document-modal-content"],[1,"document-details",2,"margin-bottom","20px"],["nzSize","small",3,"nzBordered","nzColumn"],["nzTitle","Nom du fichier"],["nzTitle","Taille"],["nzTitle","Date d'upload"],["nzTitle","Version"],["nzTitle","Statut","nzSpan","2"],[1,"document-preview",2,"text-align","center"],[1,"preview-container",2,"max-height","500px","overflow-y","auto","border","1px solid #d9d9d9","border-radius","6px","padding","16px"],[2,"max-width","100%","height","auto","box-shadow","0 2px 8px rgba(0,0,0,0.1)","border-radius","4px",3,"error","src","alt"],[2,"display","none","padding","40px","color","#999","text-align","center"],["nz-icon","","nzType","file-image","nzTheme","outline",2,"font-size","48px","margin-bottom","16px"],[2,"font-size","12px"]],template:function(e,a){if(e&1){let s=x();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"nz-card",15),m(4,"nz-statistic",16),i()(),n(5,"div",14)(6,"nz-card",17),m(7,"nz-statistic",18),i()(),n(8,"div",14)(9,"nz-card",19),m(10,"nz-statistic",20),i()()(),n(11,"nz-card",21)(12,"div",22)(13,"h3"),l(14,"Gestion des Utilisateurs"),i(),n(15,"nz-space"),g(16,Ut,3,1,"button",23),i()(),n(17,"div",24)(18,"nz-input-group",25)(19,"input",26),O("ngModelChange",function(d){return f(s),w(a.searchTerm,d)||(a.searchTerm=d),_(d)}),z("ngModelChange",function(d){return f(s),_(a.onSearchChange(d))}),i()(),g(20,wt,1,0,"ng-template",null,0,b)(22,Tt,1,1,"ng-template",null,1,b),i()(),n(24,"nz-card",27)(25,"nz-table",28,2),z("nzPageIndexChange",function(d){return f(s),_(a.onPageChange(d))})("nzPageSizeChange",function(d){return f(s),_(a.onPageSizeChange(d))}),n(27,"thead")(28,"tr")(29,"th",29),l(30,"Photo"),i(),n(31,"th",30),l(32,"Nom"),i(),n(33,"th",30),l(34,"Pr\xE9nom"),i(),n(35,"th",31),l(36,"Email"),i(),n(37,"th",32),l(38,"T\xE9l\xE9phone"),i(),n(39,"th",30),l(40,"Poste"),i(),n(41,"th",33),l(42,"Service"),i(),n(43,"th",30),l(44,"Type"),i(),n(45,"th",34),l(46,"Statut"),i(),n(47,"th",35),l(48,"Inscription"),i(),n(49,"th",35),l(50,"Derni\xE8re Connexion"),i(),n(51,"th",29),l(52,"Admin"),i(),n(53,"th",36),l(54,"Actions"),i()()(),n(55,"tbody"),g(56,Bt,53,25,"tr",37),i()(),g(57,Gt,5,0,"div",38)(58,Jt,5,0,"div",39),i()(),n(59,"nz-modal",40),O("nzVisibleChange",function(d){return f(s),w(a.isEditModalVisible,d)||(a.isEditModalVisible=d),_(d)}),z("nzOnCancel",function(){return f(s),_(a.closeEditModalWithCleanup())})("nzOnOk",function(){return f(s),_(a.submitEditWithDocuments())}),g(60,pn,130,56,"ng-container",41),i(),n(61,"nz-modal",42),O("nzVisibleChange",function(d){return f(s),w(a.isStatusModalVisible,d)||(a.isStatusModalVisible=d),_(d)}),z("nzOnCancel",function(){return f(s),_(a.closeStatusModal())})("nzOnOk",function(){return f(s),_(a.confirmStatusChange())}),g(62,hn,11,5,"ng-container",41),i(),n(63,"nz-modal",43),O("nzVisibleChange",function(d){return f(s),w(a.isDocumentModalVisible,d)||(a.isDocumentModalVisible=d),_(d)}),z("nzOnCancel",function(){return f(s),_(a.closeDocumentModal())}),g(64,xn,2,1,"div",41),i()}if(e&2){let s=v(21),p=v(23),d=v(26);r(),c("nzGutter",16),r(3),c("nzValue",a.totalUsers)("nzValueStyle",S(37,St)),r(3),c("nzValue",a.totalAdmins)("nzValueStyle",S(38,Et)),r(3),c("nzValue",a.totalRegularUsers)("nzValueStyle",S(39,Pt)),r(8),c("nzPrefix",s)("nzSuffix",p),r(),U("ngModel",a.searchTerm),r(6),c("nzData",a.getPaginatedUsers())("nzLoading",a.loading)("nzFrontPagination",!1)("nzTotal",a.totalItems)("nzPageSize",a.pageSize)("nzPageIndex",a.currentPage)("nzPageSizeOptions",S(40,yt))("nzShowSizeChanger",!0)("nzScroll",S(41,Mt)),r(31),c("ngForOf",d.data)("ngForTrackBy",a.trackByUserId),r(),c("ngIf",!a.loading&&a.filteredUsers.length===0&&a.searchTerm),r(),c("ngIf",!a.loading&&a.users.length===0),r(),U("nzVisible",a.isEditModalVisible),c("nzOkText","Modifier")("nzCancelText","Annuler")("nzOkLoading",a.isEditLoading)("nzWidth",800),r(2),U("nzVisible",a.isStatusModalVisible),c("nzOkText","Confirmer")("nzCancelText","Annuler")("nzOkLoading",a.isStatusLoading)("nzWidth",450),r(2),U("nzVisible",a.isDocumentModalVisible),c("nzTitle",a.selectedDocument?a.selectedDocument.description_document:"Document")("nzWidth",800)("nzFooter",null)}},dependencies:[K,J,Y,be,ze,ge,fe,_e,he,Se,xe,ve,je,$e,ke,Le,We,Ae,Be,Ne,Qe,Je,Ke,Ye,de,ce,se,le,Z,Q,ct,lt,mt,dt,Ge,Re,nt,tt,et,He,Xe,qe,Me,te,ee,ne,Ee,ye,Pe,ie,ue,pe,me,st,ot,it,at,rt,Ve,Fe,Ie,we,Ue,De,Te,Oe,ft,gt,ut,pt,Ct,vt,xt,ht,_t,ae,re],styles:[".container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto;background:#f5f5f5;min-height:100vh}.stats-section[_ngcontent-%COMP%]{margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{height:120px;border-radius:12px;box-shadow:0 4px 12px #0000001a;transition:all .3s ease;border:none}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #00000026}.total-users[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e6f7ff,#bae7ff);border-left:4px solid #1890ff}.total-admins[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f6ffed,#d9f7be);border-left:4px solid #52c41a}.total-regular-users[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff7e6,#ffd591);border-left:4px solid #fa8c16}.controls-section[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:none}.controls-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #f0f0f0}.controls-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#262626;font-size:18px;font-weight:600}.filter-container[_ngcontent-%COMP%]{max-width:400px}.search-input[_ngcontent-%COMP%]{border-radius:8px;font-size:14px}.clear-icon[_ngcontent-%COMP%]{cursor:pointer;color:#bfbfbf;transition:color .2s}.clear-icon[_ngcontent-%COMP%]:hover{color:#ff4d4f}.table-section[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;border:none;overflow:hidden}nz-table[_ngcontent-%COMP%]{background:#fff}.ant-table[_ngcontent-%COMP%]{border-radius:8px}.ant-table-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{background:#fafafa;font-weight:600;color:#262626;border-bottom:2px solid #f0f0f0;font-size:13px;text-transform:uppercase;letter-spacing:.5px}.ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #f5f5f5;vertical-align:middle}.ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover > td[_ngcontent-%COMP%]{background:#f9f9f9}.ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:last-child > td[_ngcontent-%COMP%]{border-bottom:none}.text-center[_ngcontent-%COMP%]{text-align:center}.text-muted[_ngcontent-%COMP%]{color:#8c8c8c;font-style:italic}.date-column[_ngcontent-%COMP%]{font-size:12px}.date-text[_ngcontent-%COMP%]{color:#595959}.ant-tag[_ngcontent-%COMP%]{border-radius:6px;font-size:11px;font-weight:500;padding:2px 8px;border:none;text-transform:uppercase;letter-spacing:.3px}.danger-action[_ngcontent-%COMP%]{color:#ff4d4f!important}.danger-action[_ngcontent-%COMP%]:hover{background:#fff2f0!important}.no-results[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]{padding:60px 20px;text-align:center;background:#fafafa;border-radius:8px;margin:20px 0}.no-results-icon[_ngcontent-%COMP%], .no-data-icon[_ngcontent-%COMP%]{font-size:48px;color:#d9d9d9;margin-bottom:16px}.no-results-text[_ngcontent-%COMP%], .no-data-text[_ngcontent-%COMP%]{font-size:16px;color:#8c8c8c;margin-bottom:16px}.ant-btn[_ngcontent-%COMP%]{border-radius:6px;font-weight:500;transition:all .3s ease}.ant-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.ant-btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1890ff,#096dd9);border:none;box-shadow:0 2px 4px #1890ff4d}.ant-btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#40a9ff,#1890ff);box-shadow:0 4px 8px #1890ff66}a[_ngcontent-%COMP%]{color:#1890ff;text-decoration:none;transition:color .2s}a[_ngcontent-%COMP%]:hover{color:#40a9ff;text-decoration:underline}.ant-pagination[_ngcontent-%COMP%]{margin:24px 0 0;text-align:right}.ant-pagination-item[_ngcontent-%COMP%]{border-radius:6px}.ant-pagination-item-active[_ngcontent-%COMP%]{background:#1890ff;border-color:#1890ff}.ant-modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0f9ff,#e0f2fe);border-bottom:2px solid #e6f7ff;border-radius:8px 8px 0 0}.ant-modal-title[_ngcontent-%COMP%]{color:#1890ff;font-weight:600;font-size:16px}.ant-modal-body[_ngcontent-%COMP%]{padding:24px;max-height:70vh;overflow-y:auto}.ant-modal-footer[_ngcontent-%COMP%]{border-top:1px solid #f0f0f0;padding:12px 24px;text-align:right}.ant-form-item[_ngcontent-%COMP%]{margin-bottom:20px}.ant-form-item-label[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{font-weight:600;color:#262626}.ant-form-item-label[_ngcontent-%COMP%] > label.ant-form-item-required[_ngcontent-%COMP%]:before{color:#ff4d4f;font-size:14px}.error-input[_ngcontent-%COMP%]{border-color:#ff4d4f!important;box-shadow:0 0 0 2px #ff4d4f33!important}.ant-input[_ngcontent-%COMP%]:focus, .ant-select-selector[_ngcontent-%COMP%]:focus, .ant-select-focused[_ngcontent-%COMP%]   .ant-select-selector[_ngcontent-%COMP%]{border-color:#1890ff!important;box-shadow:0 0 0 2px #1890ff33!important}.status-change-content[_ngcontent-%COMP%]{padding:16px 0}.user-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#262626;font-size:16px;display:flex;align-items:center;gap:8px}.current-status[_ngcontent-%COMP%]{margin:0 0 16px;color:#595959;font-size:14px;display:flex;align-items:center;gap:8px}.status-selection[_ngcontent-%COMP%]{margin-bottom:20px}.status-selection[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 12px;color:#262626;font-weight:600}.status-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.status-radio-option[_ngcontent-%COMP%]{display:flex!important;align-items:center;padding:8px 12px;border:1px solid #d9d9d9;border-radius:6px;transition:all .2s;cursor:pointer}.status-radio-option[_ngcontent-%COMP%]:hover{border-color:#1890ff;background:#f6f6f6}.ant-radio-wrapper-checked[_ngcontent-%COMP%]   .status-radio-option[_ngcontent-%COMP%]{border-color:#1890ff;background:#e6f7ff}.status-tag[_ngcontent-%COMP%]{margin-left:8px;pointer-events:none}.status-warning[_ngcontent-%COMP%]{margin-top:16px}@media (max-width: 768px){.ant-modal[_ngcontent-%COMP%]{width:95%!important;max-width:95%!important}.ant-modal-body[_ngcontent-%COMP%]{padding:16px}.status-radio-group[_ngcontent-%COMP%]{gap:8px}.status-radio-option[_ngcontent-%COMP%]{padding:6px 10px}}@media (max-width: 1200px){.container[_ngcontent-%COMP%]{padding:16px}.controls-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.filter-container[_ngcontent-%COMP%]{max-width:100%;width:100%}}@media (max-width: 768px){.stats-section[_ngcontent-%COMP%]   .ant-col[_ngcontent-%COMP%]{margin-bottom:16px}.stat-card[_ngcontent-%COMP%]{height:auto;min-height:100px}.controls-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.ant-table-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{font-size:12px}.date-column[_ngcontent-%COMP%]{font-size:11px}}@media (max-width: 576px){.container[_ngcontent-%COMP%]{padding:12px}.stats-section[_ngcontent-%COMP%], .controls-section[_ngcontent-%COMP%], .table-section[_ngcontent-%COMP%]{margin-bottom:16px}.controls-header[_ngcontent-%COMP%]{text-align:center}.no-results[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]{padding:40px 15px}.no-results-icon[_ngcontent-%COMP%], .no-data-icon[_ngcontent-%COMP%]{font-size:36px}.no-results-text[_ngcontent-%COMP%], .no-data-text[_ngcontent-%COMP%]{font-size:14px}}.ant-spin-container[_ngcontent-%COMP%]{transition:opacity .3s}.ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:focus{outline:2px solid #1890ff;outline-offset:-2px}.ant-btn[_ngcontent-%COMP%]:focus{outline:2px solid #1890ff;outline-offset:2px}.ant-statistic-title[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#8c8c8c;margin-bottom:8px}.ant-statistic-content[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.total-users[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#d4edfc,#a8d8f0)}.total-admins[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#e8f5e8,#c5e8c5)}.total-regular-users[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ffefd6,#ffcc7a)}.ant-table-placeholder[_ngcontent-%COMP%]{background:#fafafa;border-radius:8px}.ant-table-body[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.ant-table-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.ant-table-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.ant-table-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.ant-tag.ant-tag-green[_ngcontent-%COMP%]{background:#f6ffed;color:#52c41a;border:1px solid #b7eb8f}.ant-tag.ant-tag-orange[_ngcontent-%COMP%]{background:#fff7e6;color:#fa8c16;border:1px solid #ffd591}.ant-tag.ant-tag-red[_ngcontent-%COMP%]{background:#fff2f0;color:#ff4d4f;border:1px solid #ffccc7}.ant-tag.ant-tag-blue[_ngcontent-%COMP%]{background:#e6f7ff;color:#1890ff;border:1px solid #91d5ff}.ant-tag.ant-tag-purple[_ngcontent-%COMP%]{background:#f9f0ff;color:#722ed1;border:1px solid #d3adf7}.ant-tag.ant-tag-cyan[_ngcontent-%COMP%]{background:#e6fffb;color:#13c2c2;border:1px solid #87e8de}.user-avatar-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:4px}.user-avatar[_ngcontent-%COMP%]{border:2px solid #f0f0f0;transition:all .3s ease;box-shadow:0 2px 4px #0000001a}.user-avatar[_ngcontent-%COMP%]:hover{border-color:#1890ff;transform:scale(1.05);box-shadow:0 4px 8px #1890ff4d}.ant-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0f0f0,#d9d9d9);color:#8c8c8c;font-weight:500}.ant-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;border-radius:50%}@media (max-width: 768px){.user-avatar[_ngcontent-%COMP%]{width:32px!important;height:32px!important;min-width:32px!important;line-height:30px!important;font-size:12px!important}}"]})};export{bt as UsersComponent};
