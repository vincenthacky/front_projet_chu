import{a as h}from"./chunk-M37DKQAG.js";import{c,g as d}from"./chunk-YLHBJJO7.js";import{E as a,da as m,g as u,ia as b,o,r as i}from"./chunk-EIVDWLNO.js";var E=class l{constructor(e){this.http=e}API_BASE_URL=h.apiUrl;RECOMPENSES_ENDPOINT=`${this.API_BASE_URL}/recompenses`;recompensesSubject=new u([]);recompenses$=this.recompensesSubject.asObservable();loadingSubject=new u(!1);loading$=this.loadingSubject.asObservable();paginationSubject=new u(null);pagination$=this.paginationSubject.asObservable();getUserRecompenses(e=1,r=15,t){this.loadingSubject.next(!0);let s=new c().set("page",e.toString()).set("per_page",r.toString());return t&&Object.keys(t).forEach(n=>{let p=t[n];p!=null&&p!==""&&(s=s.set(n,p.toString()))}),this.http.get(`${this.RECOMPENSES_ENDPOINT}/utilisateur`,{params:s}).pipe(i(n=>(this.recompensesSubject.next(n.data),this.paginationSubject.next(n.pagination),this.loadingSubject.next(!1),n)),a(n=>(this.loadingSubject.next(!1),console.error("Erreur lors du chargement des r\xE9compenses utilisateur:",n),o(()=>new Error("Erreur lors du chargement des r\xE9compenses")))))}getAllRecompenses(e=1,r=15,t){this.loadingSubject.next(!0);let s=new c().set("page",e.toString()).set("per_page",r.toString());return t&&Object.keys(t).forEach(n=>{let p=t[n];p!=null&&p!==""&&(s=s.set(n,p.toString()))}),this.http.get(this.RECOMPENSES_ENDPOINT,{params:s}).pipe(i(n=>(this.recompensesSubject.next(n.data),this.paginationSubject.next(n.pagination),this.loadingSubject.next(!1),n)),a(n=>(this.loadingSubject.next(!1),console.error("Erreur lors du chargement des r\xE9compenses:",n),o(()=>new Error("Erreur lors du chargement des r\xE9compenses")))))}getRecompenses(e=1,r=15,t,s){return s?this.getUserRecompenses(e,r,t):this.getAllRecompenses(e,r,t)}getRecompenseById(e){return this.http.get(`${this.RECOMPENSES_ENDPOINT}/${e}`).pipe(i(r=>r.data),a(r=>(console.error("Erreur lors du chargement de la r\xE9compense:",r),o(()=>new Error("R\xE9compense non trouv\xE9e")))))}createRecompense(e){return this.loadingSubject.next(!0),this.http.post(this.RECOMPENSES_ENDPOINT,e).pipe(i(r=>(this.loadingSubject.next(!1),r.data)),a(r=>(this.loadingSubject.next(!1),console.error("Erreur lors de la cr\xE9ation de la r\xE9compense:",r),o(()=>new Error("Erreur lors de la cr\xE9ation de la r\xE9compense")))))}updateRecompense(e,r){return this.loadingSubject.next(!0),this.http.put(`${this.RECOMPENSES_ENDPOINT}/${e}`,r).pipe(i(t=>(this.loadingSubject.next(!1),t.data)),a(t=>(this.loadingSubject.next(!1),console.error("Erreur lors de la mise \xE0 jour de la r\xE9compense:",t),o(()=>new Error("Erreur lors de la mise \xE0 jour de la r\xE9compense")))))}deleteRecompense(e){return this.loadingSubject.next(!0),this.http.delete(`${this.RECOMPENSES_ENDPOINT}/${e}`).pipe(i(r=>(this.loadingSubject.next(!1),r.success)),a(r=>(this.loadingSubject.next(!1),console.error("Erreur lors de la suppression de la r\xE9compense:",r),o(()=>new Error("Erreur lors de la suppression de la r\xE9compense")))))}updateStatutRecompense(e,r){this.loadingSubject.next(!0);let t={statut_recompense:r};return this.http.patch(`${this.RECOMPENSES_ENDPOINT}/${e}/statut`,t).pipe(i(s=>(this.loadingSubject.next(!1),s.data)),a(s=>(this.loadingSubject.next(!1),console.error("Erreur lors de la mise \xE0 jour du statut:",s),o(()=>new Error("Erreur lors de la mise \xE0 jour du statut")))))}getRecompensesStats(){return this.http.get(`${this.RECOMPENSES_ENDPOINT}/stats`).pipe(a(e=>(console.error("Erreur lors du chargement des statistiques:",e),o(()=>new Error("Erreur lors du chargement des statistiques")))))}getTypesRecompenses(){return this.http.get(`${this.API_BASE_URL}/types-recompenses`).pipe(i(e=>e.data),a(e=>(console.error("Erreur lors du chargement des types de r\xE9compenses:",e),o(()=>new Error("Erreur lors du chargement des types de r\xE9compenses")))))}exportRecompenses(e){let r=new c;return e&&Object.keys(e).forEach(t=>{let s=e[t];s!=null&&s!==""&&(r=r.set(t,s.toString()))}),this.http.get(`${this.RECOMPENSES_ENDPOINT}/export`,{params:r,responseType:"blob"}).pipe(a(t=>(console.error("Erreur lors de l'export des r\xE9compenses:",t),o(()=>new Error("Erreur lors de l'export des r\xE9compenses")))))}bulkAction(e,r){this.loadingSubject.next(!0);let t={ids:e,action:r};return this.http.post(`${this.RECOMPENSES_ENDPOINT}/bulk-action`,t).pipe(i(s=>(this.loadingSubject.next(!1),s.success)),a(s=>(this.loadingSubject.next(!1),console.error("Erreur lors de l'action en lot:",s),o(()=>new Error("Erreur lors de l'action en lot")))))}formatCurrency(e){let r=typeof e=="string"?parseFloat(e):e;return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(r)}formatDate(e){return e?new Date(e).toLocaleDateString("fr-FR"):"N/A"}getStatusLabel(e){return{due:"Due",attribuee:"Attribu\xE9e",annulee:"Annul\xE9e"}[e]||e}resetState(){this.recompensesSubject.next([]),this.paginationSubject.next(null),this.loadingSubject.next(!1)}static \u0275fac=function(r){return new(r||l)(b(d))};static \u0275prov=m({token:l,factory:l.\u0275fac,providedIn:"root"})};export{E as a};
