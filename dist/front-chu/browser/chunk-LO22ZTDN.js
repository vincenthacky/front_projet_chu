import{a as j}from"./chunk-B45Q3UJ5.js";import{a as F,b as L}from"./chunk-OSEQ4WIA.js";import{a as $,c as R}from"./chunk-WGMYJEJ4.js";import"./chunk-PJQGREK5.js";import"./chunk-4FK3KGSF.js";import{b as T,d as N}from"./chunk-HPXRSP2X.js";import"./chunk-YLHBJJO7.js";import{A as z,r as A,s as k,t as D}from"./chunk-H734YLDB.js";import{Ab as P,Mb as i,Nb as a,Ob as l,Yb as E,_b as f,fb as r,gb as h,hc as o,ic as m,jc as y,kc as M,oa as S,qc as I,vb as b,zb as g}from"./chunk-EIVDWLNO.js";import"./chunk-4CLCTAJ7.js";function U(s,t){if(s&1&&(i(0,"div",16)(1,"nz-spin",17),l(2,"div",18),a()()),s&2){let e=f();r(),g("nzSpinning",e.loading)("nzSize","large")}}function q(s,t){if(s&1&&(i(0,"div",43),o(1),a()),s&2){let e=f(2);r(),y(" ",e.getValidPaymentsCount()," paiement(s) enregistr\xE9(s) ")}}function G(s,t){if(s&1&&(i(0,"div",53),l(1,"i",7),i(2,"span",55),o(3,"R\xE9f\xE9rence:"),a(),i(4,"span",67),o(5),a()()),s&2){let e=f().$implicit;r(5),m(e.reference_paiement)}}function Y(s,t){if(s&1&&(i(0,"div",53),l(1,"i",68),i(2,"span",55),o(3,"Date de saisie:"),a(),i(4,"span",56),o(5),a()()),s&2){let e=f().$implicit,n=f(2);r(5),m(n.formatPaymentDate(e.date_saisie))}}function H(s,t){if(s&1&&(i(0,"div",52)(1,"div",69),l(2,"i",70),i(3,"span",55),o(4,"P\xE9nalit\xE9 appliqu\xE9e:"),a(),i(5,"span",71),o(6),a()()()),s&2){let e=f().$implicit,n=f(2);r(6),m(n.formatCurrency(e.penalite_appliquee))}}function W(s,t){if(s&1&&(i(0,"div",72),l(1,"i",73),i(2,"span",74),o(3),a()()),s&2){let e=f().$implicit;r(3),m(e.commentaire_paiement)}}function Z(s,t){if(s&1&&(i(0,"div",44)(1,"div",45)(2,"div",46)(3,"div",47),l(4,"i",48),i(5,"span",49),o(6),a()(),i(7,"div",50),o(8),a()(),i(9,"div",51)(10,"div",52)(11,"div",53),l(12,"i",54),i(13,"span",55),o(14,"Date de paiement:"),a(),i(15,"span",56),o(16),a()(),i(17,"div",53),l(18,"i",57),i(19,"span",55),o(20,"Montant pay\xE9:"),a(),i(21,"span",58),o(22),a()()(),i(23,"div",52)(24,"div",53),l(25,"i",59),i(26,"span",55),o(27,"Mode de paiement:"),a(),i(28,"span",60),o(29),a()(),b(30,G,6,1,"div",61),a(),i(31,"div",62)(32,"div",53),l(33,"i",63),i(34,"span",55),o(35,"Enregistr\xE9 par:"),a(),i(36,"span",64),o(37),a()(),b(38,Y,6,1,"div",61),a(),b(39,H,7,1,"div",65)(40,W,4,1,"div",66),a()()()),s&2){let e=t.$implicit,n=f(2);r(6),y("Mensualit\xE9 #",e.numero_mensualite,""),r(),g("ngClass",n.getPaymentStatusClass(e.statut_versement)),r(),y(" ",n.getPaymentStatusText(e.statut_versement)," "),r(8),m(n.formatPaymentDate(e.date_paiement_effectif)),r(6),m(n.formatCurrency(e.montant_paye)),r(7),m(n.getPaymentModeText(e.mode_paiement)),r(),g("ngIf",e.reference_paiement),r(7),m(n.getAdminName()),r(),g("ngIf",e.date_saisie),r(),g("ngIf",e.penalite_appliquee&&e.penalite_appliquee!="0.00"),r(),g("ngIf",e.commentaire_paiement)}}function J(s,t){s&1&&(i(0,"nz-empty",75)(1,"div",76)(2,"p")(3,"strong"),o(4,"Aucun paiement n'a encore \xE9t\xE9 effectu\xE9 pour cette souscription."),a()(),i(5,"p"),o(6,"Les paiements appara\xEEtront ici une fois qu'ils seront enregistr\xE9s par l'administration."),a()()())}function Q(s,t){if(s&1&&(i(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),l(4,"i",23),a(),i(5,"div",24),o(6),a(),i(7,"div",25),o(8,"Type de terrain"),a()(),i(9,"div",21)(10,"div",22),l(11,"i",26),a(),i(12,"div",24),o(13),a(),i(14,"div",25),o(15,"Prix total"),a()(),i(16,"div",21)(17,"div",22),l(18,"i",27),a(),i(19,"div",24),o(20),a(),i(21,"div",25),o(22,"Montant pay\xE9"),a()(),i(23,"div",21)(24,"div",22),l(25,"i",27),a(),i(26,"div",24),o(27),a(),i(28,"div",25),o(29,"Reste \xE0 payer"),a()()(),i(30,"div",28)(31,"div",29)(32,"h3",30),l(33,"i",31),o(34," Progression du paiement "),a(),i(35,"div",32),o(36),a()(),i(37,"div",33),l(38,"div",34),a()(),i(39,"div",35)(40,"div",36)(41,"h3",37),l(42,"i",38),o(43," Historique des paiements "),a(),b(44,q,2,1,"div",39),a(),i(45,"div",40),b(46,Z,41,11,"div",41)(47,J,7,0,"nz-empty",42),a()()()),s&2){let e=f();r(6),m(e.subscription.terrain),r(7),m(e.formatNumber(e.subscription.prixTotal)),r(6),P("color",e.getMontantPayeColor()),r(),m(e.formatNumber(e.subscription.montantPaye)),r(6),P("color",e.getResteAPayerColor()),r(),m(e.formatNumber(e.subscription.resteAPayer)),r(9),y("",e.subscription.progression,"%"),r(2),P("width",e.subscription.progression,"%"),r(6),g("ngIf",e.apiData==null?null:e.apiData.planpaiements),r(2),g("ngForOf",e.getValidPayments())("ngForTrackBy",e.trackByPaymentEnhanced),r(),g("ngIf",!e.loading&&e.getValidPaymentsCount()===0)}}var B=class s{constructor(t,e,n){this.route=t;this.router=e;this.souscriptionService=n}subscription=null;apiData=null;loading=!1;subscriptionId=null;ngOnInit(){console.log("\u{1F680} Initialisation du composant PaymentDetails"),this.route.params.subscribe(t=>{this.subscriptionId=t.id,console.log("\u{1F4CB} ID de souscription re\xE7u:",this.subscriptionId),this.subscriptionId?this.loadSubscriptionDetails():(console.error("\u274C Aucun ID de souscription fourni"),this.router.navigate(["/dashboard/user/subscriptions"]))})}loadSubscriptionDetails(){if(!this.subscriptionId)return;console.log("\u{1F50D} === CHARGEMENT D\xC9TAILS SOUSCRIPTION ==="),console.log("\u{1F4CB} ID:",this.subscriptionId),this.loading=!0;let t=parseInt(this.subscriptionId,10);this.souscriptionService.getSouscriptionById(t).subscribe({next:e=>{console.log("\u{1F4E5} R\xE9ponse API d\xE9tails:",e),e.success&&e.data?(this.apiData=e.data,this.subscription=this.mapApiDataToSubscription(e.data),console.log("\u2705 Souscription mapp\xE9e:",this.subscription),console.log("\u{1F4CA} Progression calcul\xE9e:",this.subscription.progression+"%")):(console.error("\u274C R\xE9ponse API invalide:",e),this.router.navigate(["/dashboard/user/subscriptions"])),this.loading=!1},error:e=>{console.error("\u274C Erreur lors du chargement des d\xE9tails:",e),this.loading=!1,this.router.navigate(["/dashboard/user/subscriptions"])}})}calculateProgressPercentage(t,e){if(console.log("\u{1F522} === CALCUL PROGRESSION ==="),console.log("   Prix total (montant_total_souscrit):",t),console.log("   Montant pay\xE9:",e),!t||t<=0)return console.warn("\u26A0\uFE0F Prix total invalide:",t),0;if(!e||e<0)return console.warn("\u26A0\uFE0F Montant pay\xE9 invalide:",e),0;let n=e/t*100,p=Math.min(Math.round(n*100)/100,100);return console.log("   Pourcentage brut:",n.toFixed(2)+"%"),console.log("   Pourcentage final:",p+"%"),p}mapApiDataToSubscription(t){console.log("\u{1F5FA}\uFE0F === D\xC9BUT MAPPING SOUSCRIPTION ===");let e=t.montant_total_souscrit,n=t.montant_paye,p=parseFloat(this.parseAmountSafely(e).toString()),c=parseFloat(this.parseAmountSafely(n).toString()),u=Math.max(0,p-c);console.log("\u{1F4B0} === MONTANTS EXTRAITS ET PARSES (CORRIG\xC9S) ==="),console.log("   Prix total (montant_total_souscrit) - Brut:",e,"\u2192 Pars\xE9:",p),console.log("   Montant pay\xE9 - Brut:",n,"\u2192 Pars\xE9:",c),console.log("   Reste \xE0 payer - Calcul\xE9:",u,"(= prixTotal - montantPaye)"),console.log("   Reste API (ignor\xE9):",t.reste_a_payer);let w=this.calculateProgressPercentage(p,c);console.log("\u{1F50D} V\xE9rification coh\xE9rence:",{prixTotal:p,montantPaye:c,resteCalcule:u,progression:w+"%",coherent:p===c+u});let _="en-cours";try{let x=this.souscriptionService.getStatusWithColor(t);_=this.mapApiStatusToLocal(x.status),console.log("\u{1F4CB} Statut d\xE9termin\xE9:",_)}catch(x){console.warn("\u26A0\uFE0F Erreur lors du calcul du statut, utilisation du statut par d\xE9faut:",x),_=u<=0?"termine":"en-cours"}let v=this.mapPaymentsSafely(t.planpaiements||[]);console.log("\u{1F4B3} === PAIEMENTS MAPP\xC9S ==="),console.log(`   Nombre de plans API: ${t.planpaiements?.length||0}`),console.log(`   Nombre de paiements valides: ${v.length}`);let O=v.reduce((x,V)=>x+V.amount,0);console.log("\u{1F4B0} Somme des paiements mapp\xE9s:",O),console.log("   Correspond au montant total API:",Math.abs(O-c)<1);let C="N/A";if(t.date_prochain)C=this.formatDateForPayment(t.date_prochain);else if(u>0){let x=new Date(t.date_souscription);x.setMonth(x.getMonth()+1),C=this.formatDateForPayment(x.toISOString().split("T")[0])}let d={id:`SUB${t.id_souscription?.toString().padStart(3,"0")||"000"}`,terrain:t.terrain?.libelle||"Terrain non sp\xE9cifi\xE9",surface:t.terrain?.superficie?.toString()||"N/A",prixTotal:p,montantPaye:c,resteAPayer:u,dateDebut:this.formatDateForPayment(t.date_souscription),prochainPaiement:C,statut:_,progression:w,payments:v};return console.log("\u2705 === R\xC9SULTAT MAPPING FINAL ==="),console.log("\u{1F4CA} Donn\xE9es finales:",{id:d.id,terrain:d.terrain,prixTotal:`${this.formatNumber(d.prixTotal)} (${d.prixTotal})`,montantPaye:`${this.formatNumber(d.montantPaye)} (${d.montantPaye})`,resteAPayer:`${this.formatNumber(d.resteAPayer)} (${d.resteAPayer})`,progression:`${d.progression}%`,statut:d.statut,totalPayments:d.payments.length,prochainPaiement:d.prochainPaiement}),d}parseAmountSafely(t){if(t==null)return console.warn("\u26A0\uFE0F Montant null/undefined, retourne 0"),0;if(typeof t=="number")return console.log(`\u{1F4B0} Montant d\xE9j\xE0 number: ${t}`),t;if(typeof t=="string"){let e=this.souscriptionService.parseAmount(t);return console.log(`\u{1F4B0} Montant string "${t}" \u2192 pars\xE9: ${e}`),e}try{let e=this.souscriptionService.parseAmount(t.toString());return console.log(`\u{1F4B0} Montant autre type "${t}" \u2192 pars\xE9: ${e}`),e}catch(e){return console.error("\u274C Erreur parsing montant:",t,e),0}}mapPaymentsSafely(t){if(!Array.isArray(t))return console.warn("\u26A0\uFE0F planpaiements n'est pas un tableau:",t),[];if(t.length===0)return console.log("\u2139\uFE0F Aucun plan de paiement trouv\xE9"),[];let e=t.filter((n,p)=>{let c=n&&typeof n.numero_mensualite=="number"&&n.numero_mensualite>0&&(n.montant_paye||n.montant_paye===0);return c||console.warn(`\u26A0\uFE0F Plan ${p+1} ignor\xE9 - donn\xE9es invalides:`,{numero_mensualite:n?.numero_mensualite,montant_paye:n?.montant_paye}),c}).map((n,p)=>{let c=this.parseAmountSafely(n.montant_paye),u={date:this.formatDateForPayment(n.date_paiement_effectif||n.date_paiement||""),amount:c,numero_mensualite:n.numero_mensualite,mode_paiement:n.mode_paiement||"Non sp\xE9cifi\xE9",reference_paiement:n.reference_paiement||void 0,statut_versement:n.statut_versement||"non_effectue"};return p<3&&console.log(`\u{1F4B3} Paiement ${p+1}:`,{numero:u.numero_mensualite,amount:c,date:u.date,mode:u.mode_paiement,statut:u.statut_versement}),u}).sort((n,p)=>p.numero_mensualite-n.numero_mensualite);return console.log(`\u{1F4B3} Mapping termin\xE9: ${t.length} plans \u2192 ${e.length} paiements valides`),e}mapApiStatusToLocal(t){if(!t)return console.warn("\u26A0\uFE0F Statut API vide, utilisation du statut par d\xE9faut"),"en-cours";switch(t.toLowerCase()){case"termine":case"termin\xE9":return"termine";case"en_retard":case"en-retard":case"retard":return"en-retard";case"en_cours":case"en-cours":case"actif":case"active":case"activ\xE9e":return"en-cours";default:return console.warn(`\u26A0\uFE0F Statut de souscription inconnu: "${t}", utilisation "en-cours"`),"en-cours"}}formatDateForPayment(t){if(!t)return console.warn("\u26A0\uFE0F Date vide pour formatage"),"Date non disponible";try{let e=new Date(t);if(isNaN(e.getTime()))return console.warn("\u26A0\uFE0F Date invalide:",t),"Date invalide";let n=e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});return console.log(`\u{1F4C5} Date format\xE9e: "${t}" \u2192 "${n}"`),n}catch(e){return console.error("\u274C Erreur lors du formatage de la date:",e,t),"Date non disponible"}}formatNumber(t){return t==null||!t&&t!==0?"0 FCFA":this.souscriptionService.formatCurrency(t)}getMontantPayeColor(){return"#10b981"}getResteAPayerColor(){return this.subscription?(this.subscription.resteAPayer??0)>0?"#f59e0b":"#10b981":"#6b7280"}trackByPayment(t,e){return`${e.numero_mensualite}-${e.date}-${e.amount}`}goBack(){console.log("\u{1F519} Retour vers les souscriptions"),this.router.navigate(["/dashboard/admin/details/souscription-admin"])}refresh(){console.log("\u{1F504} Actualisation des d\xE9tails"),this.subscriptionId&&this.loadSubscriptionDetails()}debugSubscriptionData(){if(console.log("\u{1F41B} === DEBUG PAYMENT DETAILS COMPLET ==="),console.log("\u{1F4CB} Subscription ID:",this.subscriptionId),console.log("\u23F3 \xC9tat loading:",this.loading),console.log("\u{1F4BE} Donn\xE9es subscription:",JSON.stringify(this.subscription,null,2)),this.subscription){console.log("\u{1F4CA} === STATISTIQUES D\xC9TAILL\xC9ES ==="),console.log("   ID:",this.subscription.id),console.log("   Terrain:",this.subscription.terrain),console.log("   Surface:",this.subscription.surface),console.log("   Prix total (montant_total_souscrit):",`${this.formatNumber(this.subscription.prixTotal)} (raw: ${this.subscription.prixTotal})`),console.log("   Montant pay\xE9:",`${this.formatNumber(this.subscription.montantPaye)} (raw: ${this.subscription.montantPaye})`),console.log("   Reste \xE0 payer (calcul\xE9):",`${this.formatNumber(this.subscription.resteAPayer)} (raw: ${this.subscription.resteAPayer})`),console.log("   Progression:",`${this.subscription.progression}% (raw: ${this.subscription.progression})`),console.log("   Statut:",this.subscription.statut),console.log("   Date d\xE9but:",this.subscription.dateDebut),console.log("   Prochain paiement:",this.subscription.prochainPaiement),console.log("   Nombre paiements:",this.subscription.payments.length);let t=this.calculateProgressPercentage(this.subscription.prixTotal,this.subscription.montantPaye);if(console.log("\u{1F50D} === V\xC9RIFICATION CALCUL ==="),console.log("   Progression recalcul\xE9e:",t+"%"),console.log("   Correspond:",Math.abs(t-this.subscription.progression)<.01),this.subscription.payments.length>0){console.log("\u{1F4B3} === PAIEMENTS (5 premiers) ==="),this.subscription.payments.slice(0,5).forEach((n,p)=>{console.log(`   ${p+1}. Mensualit\xE9 ${n.numero_mensualite}:`,{date:n.date,amount:`${this.formatNumber(n.amount)} (raw: ${n.amount})`,mode:n.mode_paiement,statut:n.statut_versement,reference:n.reference_paiement})});let e=this.subscription.payments.reduce((n,p)=>n+p.amount,0);console.log("\u{1F4B0} === V\xC9RIFICATION SOMME PAIEMENTS ==="),console.log("   Somme calcul\xE9e:",e),console.log("   Montant total API:",this.subscription.montantPaye),console.log("   \xC9cart:",Math.abs(e-this.subscription.montantPaye)),console.log("   Coh\xE9rent:",Math.abs(e-this.subscription.montantPaye)<1)}else console.log("\u2139\uFE0F Aucun paiement \xE0 afficher")}else console.log("\u274C Aucune donn\xE9e de souscription disponible");console.log("\u{1F41B} === FIN DEBUG ===")}getValidPayments(){return this.apiData?.planpaiements?this.apiData.planpaiements.filter(t=>t&&t.est_paye===!0&&t.montant_paye&&parseFloat(t.montant_paye.toString())>0).sort((t,e)=>e.numero_mensualite-t.numero_mensualite):[]}getValidPaymentsCount(){return this.getValidPayments().length}getPaymentModeText(t){return{especes:"Esp\xE8ces",cheque:"Ch\xE8que",virement:"Virement bancaire",carte:"Carte bancaire",mobile:"Paiement mobile",orange_money:"Orange Money",mtn_money:"MTN Money",moov_money:"Moov Money",wave:"Wave"}[t?.toLowerCase()]||t||"Non sp\xE9cifi\xE9"}formatPaymentDate(t){if(!t)return"Date non disponible";try{let e=new Date(t);return isNaN(e.getTime())?"Date invalide":e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Date non disponible"}}formatCurrency(t){if(t==null)return"0 FCFA";let e=parseFloat(t.toString());return isNaN(e)?"0 FCFA":this.souscriptionService.formatCurrency(e)}getAdminName(){if(!this.apiData?.admin)return"Administrateur non sp\xE9cifi\xE9";let t=this.apiData.admin;return`${t.prenom} ${t.nom}`.trim()||"Administrateur"}getPaymentStatusText(t){return{paye:"Pay\xE9",paye_en_retard:"Pay\xE9 en retard",paye_avance:"Pay\xE9 en avance",non_paye:"Non pay\xE9",en_attente:"En attente",annule:"Annul\xE9"}[t]||t||"Statut inconnu"}getPaymentStatusClass(t){return{paye:"status-paid",paye_en_retard:"status-late",paye_avance:"status-early",non_paye:"status-unpaid",en_attente:"status-pending",annule:"status-cancelled"}[t]||"status-unknown"}trackByPaymentEnhanced(t,e){return`${e.id_plan_paiement}-${e.numero_mensualite}-${e.montant_paye}`}ngAfterViewInit(){typeof window<"u"&&(window.debugPaymentDetails=()=>this.debugSubscriptionData(),console.log("\u{1F6E0}\uFE0F M\xE9thode de debug disponible: debugPaymentDetails()"),console.log("\u{1F4A1} Pour tester: Ouvrez la console et tapez debugPaymentDetails()"))}static \u0275fac=function(e){return new(e||s)(h(T),h(N),h(j))};static \u0275cmp=S({type:s,selectors:[["app-paiement-details-admin"]],standalone:!0,features:[I],decls:21,vars:8,consts:[[1,"container"],[1,"header-section"],[1,"header-content"],[1,"header-navigation"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],[1,"main-title"],[1,"fas","fa-receipt"],[1,"subscription-info"],[1,"subscription-badge"],[1,"fas","fa-file-contract"],[1,"subscription-date"],[1,"fas","fa-calendar-plus"],[1,"subtitle"],["class","loading-container",4,"ngIf"],["class","content-section",4,"ngIf"],[1,"loading-container"],["nzTip","Chargement des informations...",3,"nzSpinning","nzSize"],[1,"loading-placeholder"],[1,"content-section"],[1,"stats-overview"],[1,"stat-card"],[1,"stat-icon"],[1,"fas","fa-map-marked-alt"],[1,"stat-value"],[1,"stat-label"],[1,"fas","fa-money-bill"],[1,"fas","fa-coins"],[1,"progress-section"],[1,"progress-header"],[1,"progress-title"],[1,"fas","fa-chart-line"],[1,"progress-percentage"],[1,"progress-bar-container"],[1,"progress-bar-fill"],[1,"payment-history"],[1,"history-header"],[1,"history-title"],[1,"fas","fa-history"],["class","payment-count",4,"ngIf"],[1,"payment-list"],["class","payment-item-enhanced",4,"ngFor","ngForOf","ngForTrackBy"],["class","no-payments-empty","nzNotFoundImage","https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg","nzNotFoundContent","Aucun paiement enregistr\xE9",4,"ngIf"],[1,"payment-count"],[1,"payment-item-enhanced"],[1,"payment-card"],[1,"payment-header"],[1,"payment-numero"],[1,"fas","fa-calendar-check"],[1,"mensualite-badge"],[1,"payment-status",3,"ngClass"],[1,"payment-body"],[1,"payment-info-row"],[1,"info-item"],[1,"fas","fa-calendar-alt"],[1,"info-label"],[1,"info-value"],[1,"fas","fa-money-bill-wave"],[1,"info-value","amount"],[1,"fas","fa-credit-card"],[1,"info-value","mode-payment"],["class","info-item",4,"ngIf"],[1,"payment-info-row","admin-info"],[1,"fas","fa-user-shield"],[1,"info-value","admin-name"],["class","payment-info-row",4,"ngIf"],["class","payment-comment",4,"ngIf"],[1,"info-value","reference"],[1,"fas","fa-clock"],[1,"info-item","penalty"],[1,"fas","fa-exclamation-triangle"],[1,"info-value","penalty-amount"],[1,"payment-comment"],[1,"fas","fa-comment"],[1,"comment-text"],["nzNotFoundImage","https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg","nzNotFoundContent","Aucun paiement enregistr\xE9",1,"no-payments-empty"],["nz-empty-description","",1,"empty-description"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),E("click",function(){return n.goBack()}),l(5,"i",5),o(6," Retour "),a()(),i(7,"h1",6),l(8,"i",7),o(9),a(),i(10,"div",8)(11,"span",9),l(12,"i",10),o(13),a(),i(14,"span",11),l(15,"i",12),o(16),a()(),i(17,"p",13),o(18),a()()(),b(19,U,3,2,"div",14)(20,Q,48,15,"div",15),a()),e&2&&(r(9),M(" D\xE9tails des paiements de ",n.apiData==null||n.apiData.utilisateur==null?null:n.apiData.utilisateur.prenom," ",n.apiData==null||n.apiData.utilisateur==null?null:n.apiData.utilisateur.nom," "),r(4),y(" Souscription #",n.apiData==null?null:n.apiData.id_souscription," "),r(3),y(" Souscrite le ",n.formatPaymentDate((n.apiData==null?null:n.apiData.date_souscription)||"")," "),r(2),M(" Email: ",n.apiData==null||n.apiData.utilisateur==null?null:n.apiData.utilisateur.email," | T\xE9l\xE9phone: ",n.apiData==null||n.apiData.utilisateur==null?null:n.apiData.utilisateur.telephone," "),r(),g("ngIf",n.loading),r(),g("ngIf",!n.loading&&n.subscription&&n.apiData))},dependencies:[z,A,k,D,L,F,R,$],styles:['.container[_ngcontent-%COMP%]{width:100%;max-width:100%;height:100%;max-height:100%;background:#fffffffa;border-radius:12px;overflow:hidden;box-shadow:0 8px 24px #0000000f;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);display:flex;flex-direction:column;margin:0;padding:0}.header-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:clamp(8px,1.5vw,16px);text-align:center;position:relative;overflow:hidden;flex-shrink:0}.header-section[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%);animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translate(0) rotate(0)}50%{transform:translate(-15px,-15px) rotate(180deg)}}.header-content[_ngcontent-%COMP%]{position:relative;z-index:2}.main-title[_ngcontent-%COMP%]{font-size:clamp(.9rem,2.2vw,1.3rem);font-weight:800;margin-bottom:4px;display:flex;align-items:center;justify-content:center;gap:6px;flex-wrap:wrap;line-height:1.2}.subscription-badge[_ngcontent-%COMP%]{background:#fff3;padding:6px 12px;border-radius:16px;font-size:clamp(.7rem,1.4vw,.85rem);font-weight:600;border:1px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);display:flex;align-items:center;gap:6px}.subscription-info[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:16px;margin:8px 0;flex-wrap:wrap}.subscription-date[_ngcontent-%COMP%]{background:#ffffff26;padding:6px 12px;border-radius:16px;font-size:clamp(.7rem,1.4vw,.85rem);font-weight:500;border:1px solid rgba(255,255,255,.2);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);display:flex;align-items:center;gap:6px;color:#fffffff2}.subtitle[_ngcontent-%COMP%]{font-size:clamp(.65rem,1.3vw,.8rem);opacity:.9;font-weight:400;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:clamp(20px,4vw,40px);text-align:center;flex:1}.loading-spinner[_ngcontent-%COMP%]{width:28px;height:28px;border:2px solid #f3f3f3;border-top:2px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:10px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:clamp(.75rem,1.5vw,.85rem);color:#6b7280;font-weight:500;margin:0}.content-section[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:clamp(8px,1.5vw,16px)}.content-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.content-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:2px}.content-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:2px}[_ngcontent-%COMP%]:is():hover{background:#a8a8a8}.stats-overview[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:stretch;gap:clamp(2px,.4vw,4px);margin-bottom:clamp(8px,1.5vw,12px);flex-wrap:nowrap}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);padding:12px 8px;border-radius:4px;text-align:center;transition:all .3s ease;border:1px solid rgba(102,126,234,.1);position:relative;overflow:hidden;flex:1;min-width:0;display:flex;flex-direction:column;justify-content:center;font-size:1.1em}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 6px #667eea14}.stat-icon[_ngcontent-%COMP%]{width:clamp(10px,1.8vw,14px);height:clamp(10px,1.8vw,14px);background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1px;color:#fff;font-size:clamp(.35rem,.7vw,.45rem);flex-shrink:0}.stat-value[_ngcontent-%COMP%]{font-size:1.25em;font-weight:800;color:#1f2937;margin-bottom:4px;line-height:1;word-break:break-word;hyphens:auto}.stat-label[_ngcontent-%COMP%]{color:#6b7280;font-size:1em;font-weight:500;line-height:1.1;word-break:break-word}.progress-section[_ngcontent-%COMP%]{background:#fff;border-radius:6px;padding:16px 10px;margin-bottom:clamp(6px,1.2vw,10px);box-shadow:0 3px 8px #0000000a;border:1px solid #f1f5f9}.progress-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;flex-wrap:wrap;gap:4px}.progress-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;color:#1f2937;display:flex;align-items:center;gap:4px;margin:0}.progress-percentage[_ngcontent-%COMP%]{font-size:1em;font-weight:700;color:#667eea;background:#667eea1a;padding:6px 14px;border-radius:8px}.progress-bar-container[_ngcontent-%COMP%]{width:100%;height:3px;background:#e5e7eb;border-radius:2px;overflow:hidden;position:relative}.progress-bar-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(135deg,#10b981,#059669);border-radius:2px;transition:width 1s ease-in-out;position:relative;overflow:hidden}.progress-bar-fill[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:_ngcontent-%COMP%_shimmer 2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{left:-100%}to{left:100%}}.payment-history[_ngcontent-%COMP%]{background:#fff;border-radius:6px;padding:16px 10px;box-shadow:0 3px 8px #0000000a;border:1px solid #f1f5f9}.history-header[_ngcontent-%COMP%]{margin-bottom:clamp(6px,1.2vw,8px);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}.history-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;color:#1f2937;display:flex;align-items:center;gap:4px;margin:0}.payment-count[_ngcontent-%COMP%]{font-size:.9em;color:#6b7280;background:#f3f4f6;padding:4px 8px;border-radius:4px;font-weight:500}.payment-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.payment-item-enhanced[_ngcontent-%COMP%]{background:#fff;border-radius:8px;border:1px solid #e5e7eb;overflow:hidden;transition:all .3s ease;box-shadow:0 1px 3px #0000001a}.payment-item-enhanced[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026;border-color:#667eea}.payment-card[_ngcontent-%COMP%]{width:100%}.payment-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);padding:12px 16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e5e7eb}.payment-numero[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.payment-numero[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea;font-size:1.1em}.mensualite-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:4px 12px;border-radius:16px;font-size:.85em;font-weight:600;letter-spacing:.5px}.payment-status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:.8em;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.status-paid[_ngcontent-%COMP%]{background:#10b9811a;color:#059669;border:1px solid rgba(16,185,129,.2)}.status-late[_ngcontent-%COMP%]{background:#f59e0b1a;color:#d97706;border:1px solid rgba(245,158,11,.2)}.status-early[_ngcontent-%COMP%]{background:#3b82f61a;color:#2563eb;border:1px solid rgba(59,130,246,.2)}.status-unpaid[_ngcontent-%COMP%]{background:#ef44441a;color:#dc2626;border:1px solid rgba(239,68,68,.2)}.status-pending[_ngcontent-%COMP%]{background:#9ca3af1a;color:#6b7280;border:1px solid rgba(156,163,175,.2)}.status-cancelled[_ngcontent-%COMP%]{background:#6b72801a;color:#374151;border:1px solid rgba(107,114,128,.2)}.payment-body[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px}.payment-info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;min-width:0;flex:1}.info-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea;font-size:.9em;flex-shrink:0}.info-label[_ngcontent-%COMP%]{color:#6b7280;font-size:.85em;font-weight:500;white-space:nowrap;flex-shrink:0}.info-value[_ngcontent-%COMP%]{color:#1f2937;font-weight:600;font-size:.9em;word-break:break-word}.info-value.amount[_ngcontent-%COMP%]{color:#059669;font-weight:700;background:#10b9810d;padding:2px 6px;border-radius:4px}.info-value.mode-payment[_ngcontent-%COMP%]{background:#667eea0d;color:#667eea;padding:2px 6px;border-radius:4px;font-weight:600}.info-value.reference[_ngcontent-%COMP%]{font-family:Courier New,monospace;background:#f3f4f6;padding:2px 6px;border-radius:4px;font-size:.8em}.info-value.admin-name[_ngcontent-%COMP%]{color:#7c3aed;font-weight:600}.admin-info[_ngcontent-%COMP%]{background:#7c3aed05;padding:8px;border-radius:4px;border-left:3px solid #7c3aed}.penalty[_ngcontent-%COMP%]   .info-value.penalty-amount[_ngcontent-%COMP%]{color:#dc2626;background:#ef44440d;font-weight:700}.payment-comment[_ngcontent-%COMP%]{background:#f8fafc;padding:8px 12px;border-radius:4px;border-left:3px solid #667eea;display:flex;align-items:flex-start;gap:8px}.payment-comment[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea;margin-top:2px;flex-shrink:0}.comment-text[_ngcontent-%COMP%]{color:#374151;font-style:italic;font-size:.9em;line-height:1.4}.payment-item[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-radius:4px;padding:10px 8px;border:1px solid #e2e8f0;transition:all .3s ease;position:relative;overflow:hidden}.payment-item[_ngcontent-%COMP%]:hover{transform:translate(2px);box-shadow:0 2px 6px #667eea14;border-color:#a5b4fc}.payment-item[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;width:2px;height:100%;background:linear-gradient(135deg,#10b981,#059669)}.payment-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:3px}.payment-date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:3px;color:#6b7280;font-size:1em;font-weight:500}.payment-amount[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;color:#059669;background:#10b9811a;padding:5px 12px;border-radius:3px}.no-payments[_ngcontent-%COMP%]{text-align:center;padding:clamp(15px,3vw,20px);color:#9ca3af}.no-payments[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:clamp(1rem,2vw,1.2rem);margin-bottom:6px;opacity:.5}.no-payments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;margin:0}@media (max-width: 1024px){.stats-overview[_ngcontent-%COMP%]{gap:1px}.stat-card[_ngcontent-%COMP%]{padding:1px}.payment-info-row[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.info-item[_ngcontent-%COMP%]{flex:none;width:100%}}@media (max-width: 768px){.progress-header[_ngcontent-%COMP%], .payment-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:2px}.stat-card[_ngcontent-%COMP%]{padding:6px 4px;font-size:.85em}.stat-value[_ngcontent-%COMP%]{font-size:.95em;margin-bottom:2px}.stat-label[_ngcontent-%COMP%]{font-size:.8em;line-height:1.05}.payment-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px;padding:10px 12px}.payment-body[_ngcontent-%COMP%]{padding:12px;gap:10px}.payment-info-row[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.info-item[_ngcontent-%COMP%]{font-size:.9em}.mensualite-badge[_ngcontent-%COMP%]{font-size:.8em;padding:3px 8px}.payment-status[_ngcontent-%COMP%]{font-size:.75em;padding:3px 6px}.history-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}}@media (max-width: 480px){.main-title[_ngcontent-%COMP%]{flex-direction:column;gap:3px}.subscription-info[_ngcontent-%COMP%]{flex-direction:column;gap:8px;margin:6px 0}.subscription-badge[_ngcontent-%COMP%], .subscription-date[_ngcontent-%COMP%]{font-size:clamp(.65rem,1.2vw,.75rem);padding:4px 8px;gap:4px}.stats-overview[_ngcontent-%COMP%]{gap:1px}.stat-card[_ngcontent-%COMP%]{padding:4px 2px;font-size:.85em}.stat-icon[_ngcontent-%COMP%]{width:8px;height:8px;font-size:.3rem;margin-bottom:1px}.stat-value[_ngcontent-%COMP%]{font-size:.85em;margin-bottom:1px}.stat-label[_ngcontent-%COMP%]{font-size:.7em;line-height:1}.payment-list[_ngcontent-%COMP%]{font-size:.85em;gap:8px}.payment-item-enhanced[_ngcontent-%COMP%]{border-radius:6px}.payment-header[_ngcontent-%COMP%]{padding:8px 10px}.payment-body[_ngcontent-%COMP%]{padding:10px;gap:8px}.info-item[_ngcontent-%COMP%]{font-size:.85em;gap:6px}.info-label[_ngcontent-%COMP%]{font-size:.8em}.info-value[_ngcontent-%COMP%]{font-size:.85em}.mensualite-badge[_ngcontent-%COMP%]{font-size:.75em;padding:2px 6px}.payment-comment[_ngcontent-%COMP%]{padding:6px 8px;font-size:.8em}.admin-info[_ngcontent-%COMP%]{padding:6px}}[_nghost-%COMP%]{display:block;width:100%;height:100%;overflow:hidden}.header-navigation[_ngcontent-%COMP%]{margin-bottom:1rem;text-align:left;display:flex;justify-content:flex-start}.back-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 4px #0000001a}.back-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea4d;background:linear-gradient(135deg,#5a67d8,#6b46c1)}.back-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #0000001a}.back-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}@media (max-width: 768px){.back-button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:.85rem}}']})};export{B as PaiementDetailsAdminComponent};
